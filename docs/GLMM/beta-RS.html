<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Environmental degradation and collapse of Tropical Glacier Ecosystems - 11&nbsp; Magnitude of degradation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../references.html" rel="next">
<link href="../GLMM/binomial-collapse.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../GLMM/binomial-collapse.html">Compare results from different indicators</a></li><li class="breadcrumb-item"><a href="../GLMM/beta-RS.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Magnitude of degradation</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Environmental degradation and collapse of Tropical Glacier Ecosystems</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/jrfep/T6.1-tropical-glaciers-suitability-model/" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Abstract</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Assessment units</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../TGE/units.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Ecosystem description</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Indicator variables</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../IND/mass-balance-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Projection of Ice Mass Balance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../IND/suitability-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Bioclimatic suitability model</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Relative Severity and Extent of Decline</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FORM/RS-formula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">The RS formula</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FORM/mean-RS-formula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Average RS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FORM/cED-formula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">The cED formula</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Trajectories towards collapse</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RS/time-series.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Temporal change in Relative Severity</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RS/spatial-aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Uncertainty of models and scenarios</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../RS/spatial-variability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Changes in the extent of decline</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Compare results from different indicators</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GLMM/binomial-collapse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Prediction of collapse</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../GLMM/beta-RS.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Magnitude of degradation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Results per assessment unit</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A1/Mexico.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">T.G.E. Mexico</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A1/Kilimanjaro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">T.G.E. Kilimanjaro</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A1/Cordillera-de-Merida.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">T.G.E. Cordillera de Merida</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A1/Colombia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">T.G.E. Cordilleras de Colombia</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A1/Ecuador.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">T.G.E. Ecuador</span></span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">Code reproducibility</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../A2/general-workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">General description of workflow</span></span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#beta-distribution-glmm-of-overlinemathrmrs" id="toc-beta-distribution-glmm-of-overlinemathrmrs" class="nav-link active" data-scroll-target="#beta-distribution-glmm-of-overlinemathrmrs"><span class="header-section-number">11.1</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\overline{\mathrm{RS}}\)</span></a>
  <ul class="collapse">
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model diagnostics</a></li>
  <li><a href="#outliers" id="toc-outliers" class="nav-link" data-scroll-target="#outliers">Outliers</a></li>
  <li><a href="#model-summary" id="toc-model-summary" class="nav-link" data-scroll-target="#model-summary">Model summary</a></li>
  </ul></li>
  <li><a href="#beta-distribution-glmm-of-mathrmcedx" id="toc-beta-distribution-glmm-of-mathrmcedx" class="nav-link" data-scroll-target="#beta-distribution-glmm-of-mathrmcedx"><span class="header-section-number">11.2</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\mathrm{cED}(x)\)</span></a>
  <ul class="collapse">
  <li><a href="#mathrmced0.3" id="toc-mathrmced0.3" class="nav-link" data-scroll-target="#mathrmced0.3"><span class="math inline">\(\mathrm{cED}(0.3)\)</span></a></li>
  <li><a href="#mathrmced0.5" id="toc-mathrmced0.5" class="nav-link" data-scroll-target="#mathrmced0.5"><span class="math inline">\(\mathrm{cED}(0.5)\)</span></a></li>
  <li><a href="#mathrmced0.8" id="toc-mathrmced0.8" class="nav-link" data-scroll-target="#mathrmced0.8"><span class="math inline">\(\mathrm{cED}(0.8)\)</span></a></li>
  </ul></li>
  <li><a href="#beta-distribution-glmm-of-mathrmauc_mathrmced" id="toc-beta-distribution-glmm-of-mathrmauc_mathrmced" class="nav-link" data-scroll-target="#beta-distribution-glmm-of-mathrmauc_mathrmced"><span class="header-section-number">11.3</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\mathrm{AUC}_{\mathrm{cED}}\)</span></a>
  <ul class="collapse">
  <li><a href="#model-diagnostics-1" id="toc-model-diagnostics-1" class="nav-link" data-scroll-target="#model-diagnostics-1">Model diagnostics</a></li>
  <li><a href="#outliers-1" id="toc-outliers-1" class="nav-link" data-scroll-target="#outliers-1">Outliers</a></li>
  <li><a href="#model-summary-1" id="toc-model-summary-1" class="nav-link" data-scroll-target="#model-summary-1">Model summary</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Magnitude of degradation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>We expect that both direct and indirect indicators will have similar performance in describing the magnitude of degradation and predicting collapse. We will use two generalised linear mixed models (GLMM) to test if there are significant differences in inferences based on these estimates of relative severity.</p>
<p>For the combinations of units and models that did not reach a point of collapse, we wanted to compare the magnitude of degradation as indicated by the value of <span class="math inline">\(\overline{\mathrm{RS}}\)</span>, <span class="math inline">\(cED(0.25)\)</span>, <span class="math inline">\(cED(0.25)\)</span>, <span class="math inline">\(cED(0.25)\)</span> and <span class="math inline">\(AUC_{cED}\)</span>.</p>
<p>To compare both indicators we used the <span class="math inline">\(RS_{bcs}^{CT=acc}\)</span> and <span class="math inline">\(RS_{bcs}^{CT=ess}\)</span> for the future periods paired with the <span class="math inline">\(RS_{ice}^{CT=0}\)</span> values for the years 2040, 2070 and 2100. We coded these three periods/years as variable <span class="math inline">\(\mathrm{time}\)</span> with values <span class="math inline">\(0, 1, 2\)</span> respectively. We use the respective total or mean <span class="math inline">\(RS\)</span> values to calculate the response variable and includes a categorical variable <span class="math inline">\(\mathrm{method}\)</span> with three levels indicating either the direct indicator (<span class="math inline">\(ice\)</span>) or indirect indicator with two alternative thresholds (<span class="math inline">\(acc\)</span> or <span class="math inline">\(ess\)</span>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  model_data <span class="sc">%&gt;%</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">unit =</span> <span class="fu">factor</span>(unit, unit_order))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>RS, <span class="at">y=</span>unit, <span class="at">color=</span>method, <span class="at">group=</span><span class="fu">interaction</span>(unit,method))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="sc">~</span>time) <span class="sc">+</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="fu">expression</span>(<span class="fu">bar</span>(RS))) <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ok, here are two problems: 1. The bioclimatic suitability model perform better in the Andes than outside 2. For some reason Kilimanjaro is just completely different</p>
<p>The first issue is understandable given the uneven sample sizes, and we might deal with this using additional variables, but for Kilimanjaro it only makes sense to remove it as an outlier.</p>
<section id="beta-distribution-glmm-of-overlinemathrmrs" class="level2 page-columns page-full" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="beta-distribution-glmm-of-overlinemathrmrs"><span class="header-section-number">11.1</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\overline{\mathrm{RS}}\)</span></h2>
<p>Given that <span class="math inline">\(\overline{\mathrm{RS}}\)</span> represent a relative measure (proportion between 0 and 1), we use a beta distribution GLMM with logit link function with <span class="math inline">\(y=\overline{\mathrm{RS}}\)</span> for all observations where <span class="math inline">\(\overline{\mathrm{RS}}&lt;1\)</span>. Just as the binomial GLMM, we included fixed effects of scenarios (<span class="math inline">\(\mathrm{scenario}\)</span> with three levels) and <span class="math inline">\(\mathrm{time}\)</span>, and nested effect of <span class="math inline">\(\mathrm{method}\)</span> within each assessment unit (<span class="math inline">\(\mathrm{unit}\)</span>, 15 levels) and implied nested effects of model within <span class="math inline">\(\mathrm{method}\)</span>.</p>
<p>We prepare the data by applying the necessary filters and including a categorial variable representing Andean vs non-Andean units:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>model_data_ss <span class="ot">&lt;-</span> model_data <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(RS <span class="sc">&lt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> RS <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="sc">!</span>unit <span class="sc">%in%</span> <span class="st">"Kilimanjaro"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">andes =</span> <span class="fu">grepl</span>(<span class="st">"Peru|Colombia|Ecuador|Merida"</span>,unit),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We fit the full model, and alternative versions with modelled dispersion parameters and additional fixed effects as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_degradation_both <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(RS <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>mod_degradation_andes <span class="ot">&lt;-</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(RS <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>method<span class="sc">:</span>andes), </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method, </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>mod_degradation_disp <span class="ot">&lt;-</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(RS <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>mod_degradation_dispandes <span class="ot">&lt;-</span> </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(RS <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method<span class="sc">+</span>andes, </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The AIC criterion favours a model with the original fixed and random effect but an additional dispersion formula including method and region (Andean vs.&nbsp;non-Andean) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bbmle<span class="sc">::</span><span class="fu">AICtab</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  mod_degradation_disp,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  mod_degradation_dispandes,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  mod_degradation_andes,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  mod_degradation_both</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          dAIC  df
mod_degradation_dispandes   0.0 12
mod_degradation_andes      38.2 12
mod_degradation_disp       52.4 11
mod_degradation_both      134.9 9 </code></pre>
</div>
</div>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model diagnostics</h3>
<p>Model diagnostics and residual plots show important deviations, there is probably some effect of the unequal sample sizes between units, as we are excluding observations with <span class="math inline">\(RS=1\)</span> and these are not evenly distributed among the assessment units. Particularly, the residuals are lower for the observation with high predicted values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>mod_degradation_simres<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(mod_degradation_dispandes)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_degradation_simres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="outliers" class="level3 page-columns page-full">
<h3 class="anchored" data-anchor-id="outliers">Outliers</h3>
<div class="page-columns page-full"><p>When we examine the outliers, these are mostly unexpected low values in the T.G.E. Kilimanjaro, but these are probably related to underlying anomalies in climatic conditions in this region. </p><div class="no-row-height column-margin column-container"><span class="">In fact, when using the original formulafor the time series of the dynamic ice mass balance model there were some spurious effect of negative RS in this unit. We are using now the conditional formula of RS but there is still some unexpected structure in the residuals.</span></div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_degradation_simres<span class="sc">$</span>fittedModel<span class="sc">$</span>frame <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">outliers</span>(mod_degradation_simres))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          RS time scenario method                         unit andes
1  0.1166621    2 SSP1-2.6    acc                    Ruwenzori FALSE
2  0.1908056    2 SSP1-2.6    acc Sierra Nevada de Santa Marta FALSE
3  0.2202120    2 SSP1-2.6    acc Sierra Nevada de Santa Marta FALSE
4  0.3647246    2 SSP1-2.6    ess Sierra Nevada de Santa Marta FALSE
5  0.4837541    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE
6  0.4999853    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE
7  0.5723302    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE
8  0.6793231    2 SSP1-2.6    ice      Cordilleras de Colombia  TRUE
9  0.6668170    2 SSP1-2.6    ice      Cordilleras de Colombia  TRUE
10 0.4923106    2 SSP1-2.6    ice                      Ecuador  TRUE
11 0.6043740    2 SSP1-2.6    ice                      Ecuador  TRUE
12 0.5666947    2 SSP1-2.6    ice                      Ecuador  TRUE
13 0.4980398    2 SSP1-2.6    ice                      Ecuador  TRUE
14 0.3657955    2 SSP1-2.6    ice                      Ecuador  TRUE
15 0.3622036    2 SSP1-2.6    ice                      Ecuador  TRUE
16 0.4327956    2 SSP1-2.6    ice                      Ecuador  TRUE
17 0.5654804    2 SSP1-2.6    ice                      Ecuador  TRUE
18 0.9991269    0 SSP1-2.6    ice                  Puncak Jaya FALSE
19 0.9989429    0 SSP1-2.6    ice                  Puncak Jaya FALSE
20 0.9867472    0 SSP1-2.6    ice                    Ruwenzori FALSE</code></pre>
</div>
</div>
</section>
<section id="model-summary" class="level3">
<h3 class="anchored" data-anchor-id="model-summary">Model summary</h3>
<p>The summary of the model indicates significant positive effects of time and future scenarios in the magnitude of RS, as expected. For the method variable, the indirect indicator have significant negative effects when compared with the direct indicator, but the effect is larger for the maximum accuracy threshold. We can interpret this to be the lower, more conservative or optimistic bound of RS for this indicator. In general, variability between units is considerably larger than variability between methods, thus we can expect all three methods to reflect general patterns, but will require closer inspection to rule out interaction with the random effects of assessment units.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width=</span><span class="dv">120</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_degradation_dispandes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="font-size: 0.8em"><code> Family: beta  ( logit )
Formula:          RS ~ time + scenario + method + (1 | unit/method)
Dispersion:          ~method + andes
Data: model_data_ss

     AIC      BIC   logLik deviance df.resid 
 -4137.0  -4071.1   2080.5  -4161.0     1787 

Random effects:

Conditional model:
 Groups      Name        Variance Std.Dev.
 method:unit (Intercept) 0.3238   0.5690  
 unit        (Intercept) 0.2840   0.5329  
Number of obs: 1799, groups:  method:unit, 33; unit, 11

Conditional model:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       0.77427    0.23810    3.25  0.00115 ** 
time              1.05534    0.02399   43.99  &lt; 2e-16 ***
scenarioSSP3-7.0  0.71553    0.04045   17.69  &lt; 2e-16 ***
scenarioSSP5-8.5  0.93131    0.04124   22.58  &lt; 2e-16 ***
methodacc        -1.35694    0.24749   -5.48 4.19e-08 ***
methodess        -0.62014    0.24894   -2.49  0.01274 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  2.33828    0.06848   34.15  &lt; 2e-16 ***
methodacc   -0.53841    0.07823   -6.88 5.89e-12 ***
methodess   -0.50491    0.08449   -5.98 2.29e-09 ***
andesTRUE    0.49988    0.06867    7.28 3.34e-13 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="beta-distribution-glmm-of-mathrmcedx" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="beta-distribution-glmm-of-mathrmcedx"><span class="header-section-number">11.2</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\mathrm{cED}(x)\)</span></h2>
<p>Given that <span class="math inline">\(\mathrm{cED}(x)\)</span> represent a relative measure (proportion between 0 and 1), we can also use a beta distribution GLMM with logit link function with <span class="math inline">\(y=\mathrm{cED}(x)\)</span> for all observations where <span class="math inline">\(\mathrm{cED}(x)&lt;1\)</span>.</p>
<p>First letâ€™s prepare the dataframe considering the filters and modification applied before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>cED_model_data <span class="ot">&lt;-</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  cED_model_data <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      method <span class="sc">%in%</span> valid_methods,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="sc">!</span>unit <span class="sc">%in%</span> <span class="st">"Kilimanjaro"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">%&gt;%</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">method=</span><span class="fu">factor</span>(method, <span class="at">levels =</span> valid_methods),</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">andes =</span> <span class="fu">grepl</span>(<span class="st">"Peru|Colombia|Ecuador|Merida"</span>, unit)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="mathrmced0.3" class="level3">
<h3 class="anchored" data-anchor-id="mathrmced0.3"><span class="math inline">\(\mathrm{cED}(0.3)\)</span></h3>
<p>Just as the model above, we included fixed effects of scenarios (<span class="math inline">\(\mathrm{scenario}\)</span> with three levels) and <span class="math inline">\(\mathrm{time}\)</span>, and nested effect of <span class="math inline">\(\mathrm{method}\)</span> within each assessment unit (<span class="math inline">\(\mathrm{unit}\)</span>, 15 levels) and implied nested effects of model within <span class="math inline">\(\mathrm{method}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>model_data_ss <span class="ot">&lt;-</span> cED_model_data <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cED_30<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> cED_30<span class="sc">&lt;</span><span class="dv">1</span>) </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>mod_cED_30_andes <span class="ot">&lt;-</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(cED_30 <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method<span class="sc">+</span>andes, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> model_data_ss, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> beta_family,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model diagnostics and residual plots deviate strongly, thus we do not</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod_cED_simres<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(mod_cED_30_andes)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_cED_simres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mathrmced0.5" class="level3">
<h3 class="anchored" data-anchor-id="mathrmced0.5"><span class="math inline">\(\mathrm{cED}(0.5)\)</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model_data_ss <span class="ot">&lt;-</span> cED_model_data <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cED_50<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> cED_50<span class="sc">&lt;</span><span class="dv">1</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>mod_cED_50_andes <span class="ot">&lt;-</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(cED_50 <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method<span class="sc">+</span>andes,  </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> model_data_ss, </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> beta_family,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model diagnostics and residual plots deviate strongly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod_cED_simres<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(mod_cED_50_andes)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_cED_simres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mathrmced0.8" class="level3">
<h3 class="anchored" data-anchor-id="mathrmced0.8"><span class="math inline">\(\mathrm{cED}(0.8)\)</span></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_data_ss <span class="ot">&lt;-</span> cED_model_data <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cED_80<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> cED_80<span class="sc">&lt;</span><span class="dv">1</span>) </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>mod_cED_80_andes <span class="ot">&lt;-</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(cED_80 <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method<span class="sc">+</span>andes, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">family =</span> beta_family,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Model diagnostics and residual plots deviate strongly:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod_cED_simres<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(mod_cED_80_andes)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_cED_simres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="beta-distribution-glmm-of-mathrmauc_mathrmced" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="beta-distribution-glmm-of-mathrmauc_mathrmced"><span class="header-section-number">11.3</span> <span class="math inline">\(\beta\)</span> distribution GLMM of <span class="math inline">\(\mathrm{AUC}_{\mathrm{cED}}\)</span></h2>
<p>Given that RS represent a relative measure (proportion between 0 and 1), we use a beta distribution GLMM with logit link function with <span class="math inline">\(y=\mathrm{AUC}_{\mathrm{cED}}\)</span> for all observations where <span class="math inline">\(\mathrm{AUC}_{\mathrm{cED}}&lt;1\)</span>. Just as the model above, we included fixed effects of scenarios (<span class="math inline">\(\mathrm{scenario}\)</span> with three levels) and <span class="math inline">\(\mathrm{time}\)</span>, and nested effect of <span class="math inline">\(\mathrm{method}\)</span> within each assessment unit (<span class="math inline">\(\mathrm{unit}\)</span>, 15 levels) and implied nested effects of model within <span class="math inline">\(\mathrm{method}\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_data_ss <span class="ot">&lt;-</span> cED_model_data <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(AUC_cED<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> AUC_cED<span class="sc">&lt;</span><span class="dv">1</span>) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mod_degradation_both <span class="ot">&lt;-</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(AUC_cED <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>mod_degradation_andes <span class="ot">&lt;-</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(AUC_cED <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method) <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>method<span class="sc">:</span>andes), </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>mod_degradation_disp <span class="ot">&lt;-</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(AUC_cED <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method, </span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>mod_degradation_dispandes <span class="ot">&lt;-</span> </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(AUC_cED <span class="sc">~</span> time <span class="sc">+</span> scenario <span class="sc">+</span> method <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>unit<span class="sc">/</span>method), </span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">dispformula=</span><span class="sc">~</span>method<span class="sc">+</span>andes, </span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> model_data_ss, </span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">family=</span>beta_family,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">REML=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The AIC criterion favours the initial specification with all variables and without dispersion model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>bbmle<span class="sc">::</span><span class="fu">AICtab</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  mod_degradation_disp,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  mod_degradation_dispandes,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  mod_degradation_andes,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  mod_degradation_both</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          dAIC  df
mod_degradation_dispandes   0.0 12
mod_degradation_andes     143.9 12
mod_degradation_disp      160.1 11
mod_degradation_both      186.4 9 </code></pre>
</div>
</div>
<section id="model-diagnostics-1" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics-1">Model diagnostics</h3>
<p>Model diagnostics and residual plots look more or less ok, but there is probably some effect of the unequal sample sizes between units, as we are excluding observations with <span class="math inline">\(RS=1\)</span> and these are not evenly distributed among the assessment units.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod_cED_simres<span class="ot">&lt;-</span><span class="fu">simulateResiduals</span>(mod_degradation_dispandes)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mod_cED_simres)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="beta-RS_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="outliers-1" class="level3">
<h3 class="anchored" data-anchor-id="outliers-1">Outliers</h3>
<p>Letâ€™s examine the outliers:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mod_cED_simres<span class="sc">$</span>fittedModel<span class="sc">$</span>frame <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="fu">outliers</span>(mod_cED_simres))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     AUC_cED time scenario method                      unit andes
1  0.0110632    2 SSP1-2.6    ess               Mount Kenia FALSE
2  0.2410671    2 SSP1-2.6    ess                 Ruwenzori FALSE
3  0.0110632    2 SSP1-2.6    acc               Mount Kenia FALSE
4  0.1266893    2 SSP1-2.6    acc                 Ruwenzori FALSE
5  0.9289891    0 SSP1-2.6    acc      Cordillera de Merida  TRUE
6  1.0000000    1 SSP1-2.6    ice               Puncak Jaya FALSE
7  1.0000000    1 SSP1-2.6    ice                 Ruwenzori FALSE
8  0.4902343    2 SSP1-2.6    ice Cordilleras Norte de Peru  TRUE
9  1.0000000    1 SSP1-2.6    ice      Cordillera de Merida  TRUE
10 1.0000000    1 SSP1-2.6    ice      Cordillera de Merida  TRUE
11 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE
12 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE
13 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE
14 0.4924969    2 SSP1-2.6    ice                   Ecuador  TRUE
15 0.5024112    2 SSP1-2.6    ice                   Ecuador  TRUE
16 0.3733117    2 SSP1-2.6    ice                   Ecuador  TRUE
17 0.3634823    2 SSP1-2.6    ice                   Ecuador  TRUE
18 0.4376313    2 SSP1-2.6    ice                   Ecuador  TRUE
19 1.0000000    0 SSP3-7.0    ice               Puncak Jaya FALSE
20 1.0000000    1 SSP5-8.5    ice      Cordillera de Merida  TRUE</code></pre>
</div>
</div>
</section>
<section id="model-summary-1" class="level3">
<h3 class="anchored" data-anchor-id="model-summary-1">Model summary</h3>
<p>The summary of the model indicates significant positive effects of time and future scenarios in the magnitude of RS, as expected. For the method variable, the indirect indicator have significant negative effects when compared with the direct indicator, but the effect is larger for the maximum accuracy threshold. We can interpret this to be the lower, more conservative or optimistic bound of RS for this indicator. In general, variability between units is considerably larger than variability between methods, thus we can expect all three methods to reflect general patterns, but will require closer inspection to rule out interaction with the random effects of assessment units.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">width=</span><span class="dv">120</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_degradation_dispandes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="font-size: 0.8em"><code> Family: beta  ( logit )
Formula:          AUC_cED ~ time + scenario + method + (1 | unit/method)
Dispersion:               ~method + andes
Data: model_data_ss

     AIC      BIC   logLik deviance df.resid 
 -7389.6  -7323.6   3706.8  -7413.6     1792 

Random effects:

Conditional model:
 Groups      Name        Variance Std.Dev.
 method:unit (Intercept) 0.4280   0.6542  
 unit        (Intercept) 0.3511   0.5926  
Number of obs: 1804, groups:  method:unit, 33; unit, 11

Conditional model:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)       0.93848    0.26985    3.48 0.000506 ***
time              1.10740    0.02499   44.31  &lt; 2e-16 ***
scenarioSSP3-7.0  0.73008    0.04317   16.91  &lt; 2e-16 ***
scenarioSSP5-8.5  0.93173    0.04388   21.24  &lt; 2e-16 ***
methodess        -0.83180    0.28541   -2.91 0.003564 ** 
methodacc        -1.56336    0.28405   -5.50 3.71e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)  1.81310    0.06954  26.073  &lt; 2e-16 ***
methodess   -0.22808    0.08535  -2.672 0.007536 ** 
methodacc   -0.29254    0.07903  -3.702 0.000214 ***
andesTRUE    0.86508    0.06922  12.497  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../GLMM/binomial-collapse.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Prediction of collapse</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Created by: JR Ferrer-Paris</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jrfep">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/neomapas">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>