[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Environmental degradation and collapse of Tropical Glacier Ecosystems",
    "section": "",
    "text": "Introduction\nTropical glacier ecosystems are facing extreme pressure due to climate change and face imminent collapse in this century. We explore here future projections of one direct and one indirect indicator of key ecosystem properties and use these to describe and quantify the probable trajectories toward collapse of these ecosystem types.\nWe focus on tropical glacier ecosystems as model ecosystem for risk assessment because:\nWe use the concepts of relative severity and extent of decline to describe functional degradation of the ecosystem that can lead to ecosystem collapse. We discuss here details of the suggested formula for calculation of relative severity \\(RS\\) in 6  The RS formula and different approaches to summarise and visualise data across the extent of the ecosystem assessment unit in 8  The cED formula.\nWe compare data from one dynamic glacier model (combining ice mass balance and glacier ice dynamics) with projected degradation of climatic suitability because:",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "TGE/units.html#classification",
    "href": "TGE/units.html#classification",
    "title": "1  Ecosystem description",
    "section": "",
    "text": "Level 1: Terrestrial Realm\n\nLevel 2: T6 Polar/Alpine (cryogenic) functional biome\n\nLevel 3: T6.1 Ice sheets, glaciers and perennial snowfields\n\nSubgroup: Tropical glacier ecosystems (TGE)\nLevel 4: 12 units as follows:\n\nTropical glacier ecosystems of Cordillera de Merida\nTropical glacier ecosystems of Cordilleras Norte de Peru\nTropical glacier ecosystems of Cordilleras Orientales de Peru y Bolivia\nTropical glacier ecosystems of Cordilleras de Colombia\nTropical glacier ecosystems of Ecuador\nTropical glacier ecosystems of Kilimanjaro\nTropical glacier ecosystems of Mexico\nTropical glacier ecosystems of Mount Kenia\nTropical glacier ecosystems of Puncak Jaya\nTropical glacier ecosystems of Ruwenzori\nTropical glacier ecosystems of Sierra Nevada de Santa Marta\nTropical glacier ecosystems of Volcanos de Peru y Chile",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "TGE/units.html#spatial-distribution",
    "href": "TGE/units.html#spatial-distribution",
    "title": "1  Ecosystem description",
    "section": "1.2 Spatial distribution",
    "text": "1.2 Spatial distribution\nWe define the tropics notionally as the region between latitudes of 20 N and 20 S, and include all known glaciers from the highest summits of Puncak Jaya in Indonesia; Mount Kilimanjaro, Mount Kenya and the Rwenzori Mountains in East Africa; the Eje Volcánico Transversal of México; and tropical Andes glaciers groups of the inner tropics (including the Sierra Nevada de Santa Marta), wet outer tropics and dry outer tropics (Sagredo and Lowell, 2012; Veettil and Kamp, 2019).\nWe use available global and regional data on glacier outlines and point records to estimate the global distribution of Tropical Glacier Ecosystems. In the Randolph Glacier Inventory version 6.0 (Randolph Glacier Inventory Consortium, 2017) all tropical glaciers are includes in region Lower Latitudes. We compared these records with other global sources (Consortium, n.d.; Raup et al., 2007) and include additional point records from national glacier inventories (Barcaza et al., 2017; INAIGEM, 2018; Zalazar et al., 2020) to increase the coverage in some regions Figure 1.1.\n\n\n\n\n\n\n\n\nFigure 1.1: Outline of spatial assessment units for Tropical Glacier Ecosystems. Each assessment unit consist of one or more spatial clusters (polygons), and each cluster includes a buffer of 25km around the glacier outlines.\n\n\n\n\nWe divided Tropical glacier ecosystems into 12 regional units considering previous classifications (Sagredo and Lowell, 2012), geographical proximity and similarity in bioclimatic conditions at different scales. These boundaries are provisional, since our knowledge about the biota and biogeographical relationships between glaciers in different tropical regions of the world is incomplete (Dial and Ditto, 2020; Hotaling et al., 2017; Kuhn et al., 2011).\nSagredo and Lowell (2012) suggested a subdivision of tropical glaciers into four classes with different climatic profiles and a distinct separation from subtropical glaciers in the Andes. Their analysis excluded glaciers in tropical and subtropical latitudes of the southern hemisphere (between 20 and 30 degrees South) that could be considered transitional in terms of climate but are mostly classified as rock glaciers or permanent snowfields in national inventories. Based on ecological zonation and ice dynamics in these transitional regions, which differs from tropical regions, we suggest they are best addressed in a separate assessment.",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "TGE/units.html#conceptual-ecosystem-model",
    "href": "TGE/units.html#conceptual-ecosystem-model",
    "title": "1  Ecosystem description",
    "section": "1.3 Conceptual ecosystem model",
    "text": "1.3 Conceptual ecosystem model\nHere we consider a simplified conceptual ecosystem model for tropical glacier ecosystems including only the variables directly related to this analysis (See Ferrer-Paris et al., 2023 for details). The different ecosystem compartments [the supraglacial surfaces, englacial interior, subglacial bedrock–ice interface, proglacial streams and lakes and glacier forefields; Hotaling et al. (2017)] are simplified here as a dashed box on the bottom containing one main abiotic substrate (blue hexagon) and the key biotic component (green hexagon). The main threat (red box) is climate change, it influences three climatic features (blue hexagons) that maintain abiotic processes of ice dynamic (blue ellipses). The grey boxes represent one indirect and one direct indicators of the key abiotic processes.\n\n\n\n\n\n\n\n\nG\n\n\nclusterBio\n\n\nclusterIce\n\n\n\nclusterMB\n\n\n\nIN1\n\nBioclimatic\nvariables\n\n\n\nTR3\n\nClimate change\n\n\n\nIN1-&gt;TR3\n\n\n\n\nIN3\n\nMass\nbalance\n\n\n\nICE\n\nIce substrate\n\n\n\nIN3-&gt;ICE\n\n\n\n\nAP2\n\n Ice \nablation\n\n\n\nIN3-&gt;AP2\n\n\n\n\nAE1\n\nSnow fall\n\n\n\nAE1-&gt;IN1\n\n\n\n\nAP1\n\n Ice \n accum. \n\n\n\nAE1-&gt;AP1\n\n\n\n\n\nAE2\n\nTemperature\n\n\n\nAE2-&gt;IN1\n\n\n\n\nAE2-&gt;AP2\n\n\n\n\n\nAE3\n\nRadiation\n\n\n\nAE3-&gt;AP2\n\n\n\n\n\nCB1\n\nGlacial micro-biota\n\n\n\nICE-&gt;CB1\n\n\n\n\n\nAP1-&gt;IN3\n\n\n\n\nAP1-&gt;ICE\n\n\n\n\n\nAP2-&gt;ICE\n\n\n\n\n\nTR3-&gt;AE1\n\n\n\n\n\nTR3-&gt;AE2\n\n\n\n\n\nTR3-&gt;AE3\n\n\n\n\n\n\n\n\nFigure 1.2: Simplified Conceptual Ecosystem Model for Tropical Glacier Ecosystems",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "TGE/units.html#definition-of-collapsed-states",
    "href": "TGE/units.html#definition-of-collapsed-states",
    "title": "1  Ecosystem description",
    "section": "1.4 Definition of collapsed states",
    "text": "1.4 Definition of collapsed states\nTropical glaciers are originally formed by processes of snow and ice accumulation and ablation over geological time frames. However the characteristic microbiota can persist in the ice substrate even if processes of ice accumulation have ceased or the overall mass balance of ice is negative.\nThus we defined a glacier as collapsed when the ice substrate disappears completely (ice mass equals zero kg).\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] stringr_1.5.1 ggplot2_3.4.4 dplyr_1.1.4   leaflet_2.2.1 sf_1.0-14    \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.4            jsonlite_1.8.8          compiler_4.3.1         \n [4] tidyselect_1.2.0        Rcpp_1.0.11             jquerylib_0.1.4        \n [7] scales_1.3.0            yaml_2.3.8              fastmap_1.1.1          \n[10] here_1.0.1              R6_2.5.1                generics_0.1.3         \n[13] classInt_0.4-10         knitr_1.45              htmlwidgets_1.6.4      \n[16] tibble_3.2.1            leaflet.providers_2.0.0 units_0.8-5            \n[19] rprojroot_2.0.4         munsell_0.5.0           DBI_1.1.3              \n[22] pillar_1.9.0            rlang_1.1.2             utf8_1.2.4             \n[25] stringi_1.8.3           xfun_0.41               cli_3.6.2              \n[28] withr_2.5.2             magrittr_2.0.3          class_7.3-22           \n[31] crosstalk_1.2.1         digest_0.6.33           grid_4.3.1             \n[34] rstudioapi_0.15.0       lifecycle_1.0.4         vctrs_0.6.5            \n[37] KernSmooth_2.23-22      proxy_0.4-27            evaluate_0.23          \n[40] glue_1.6.2              colorspace_2.1-0        fansi_1.0.6            \n[43] e1071_1.7-14            rmarkdown_2.25          ellipsis_0.3.2         \n[46] tools_4.3.1             pkgconfig_2.0.3         htmltools_0.5.7        \n\n\n\n\n\n\n\nBarcaza, G., Nussbaumer, S.U., Tapia, G., Valdés, J., García, J.L., Videla, Y., Albornoz, A., Arias, V., 2017. Glacier inventory and recent glacier variations in the andes of chile, south america. Annals of Glaciology 58. https://doi.org/10.1017/aog.2017.28\n\n\nConsortium, G., n.d. GLIMS glacier database, version 1. https://doi.org/10.7265/N5V98602\n\n\nDial, R., Ditto, J., 2020. The biogeography of the glacier biome, in: Encyclopedia of the World’s Biomes. https://doi.org/10.1016/B978-0-12-409548-9.12137-2\n\n\nFerrer-Paris, J.R., Llambí, L.D., Melfo, A., Keith, D.A., 2023. IUCN red list of ecosystem assessment: Tropical glacier ecosystem of the cordillera de mérida. EcoEvoRxiv. https://doi.org/10.32942/x2vk54\n\n\nHotaling, S., Hood, E., Hamilton, T.L., 2017. Microbial ecology of mountain glacier ecosystems: Biodiversity, ecological connections and implications of a warming climate. Environmental Microbiology 19, 2935–2948. https://doi.org/https://doi.org/10.1111/1462-2920.13766\n\n\nHotaling, S., Wimberger, P.H., Kelley, J.L., Watts, H.E., 2020. Macroinvertebrates on glaciers: A key resource for terrestrial food webs? Ecology 101, e02947. https://doi.org/10.1002/ecy.2947\n\n\nINAIGEM, 2018. El inventario nacional de glaciares: Las cordilleras glaciares del perú. Instituto Nacional de Investigación en Glaciares y Ecosistemas de Montaña.\n\n\nKeith, D.A., Ferrer-Paris, J.R., Nicholson, E., Kingsford, R.T. (Eds.), 2020. IUCN global ecosystem typology 2.0: Descriptive profiles for biomes and ecosystem functional groups. IUCN, International Union for Conservation of Nature. https://doi.org/10.2305/iucn.ch.2020.13.en\n\n\nKuhn, J., Andino, P., Calvez, R., Espinosa, R., Hamerlink, L., Vie, S., Dangles, O., Jacobsen, D., 2011. Spatial variability in macroinvertebrate assemblages along and among neighbouring equatorial glacier-fed streams. Freshwater Biology 56, 2226–2244. https://doi.org/10.1111/j.1365-2427.2011.02648.x\n\n\nRandolph Glacier Inventory Consortium, 2017. Randolph glacier inventory 6.0. https://doi.org/10.7265/N5-RGI-60\n\n\nRaup, B., Racoviteanu, A., Khalsa, S.J.S., Helm, C., Armstrong, R., Arnaud, Y., 2007. The GLIMS geospatial glacier database: A new tool for studying glacier change. Global and Planetary Change 56, 101–110. https://doi.org/10.1016/j.gloplacha.2006.07.018\n\n\nSagredo, E.A., Lowell, T.V., 2012. Climatology of andean glaciers: A framework to understand glacier response to climate change. Global and Planetary Change 86-87, 101–109. https://doi.org/https://doi.org/10.1016/j.gloplacha.2012.02.010\n\n\nVeettil, Kamp, 2019. Global disappearance of tropical mountain glaciers: Observations, causes, and challenges. Geosciences 9, 196. https://doi.org/10.3390/geosciences9050196\n\n\nZalazar, L., Ferri, L., Castro, M., Gargantini, H., Gimenez, M., Pitte, P., Ruiz, L., Masiokas, M., Costa, G., Villalba, R., 2020. Spatial distribution and characteristics of andean ice masses in argentina: Results from the first national glacier inventory. Journal of Glaciology 66. https://doi.org/10.1017/jog.2020.55",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "IND/mass-balance-model.html",
    "href": "IND/mass-balance-model.html",
    "title": "3  Projection of Ice Mass Balance",
    "section": "",
    "text": "We use ice mass balance projections for all tropical glaciers based on a glacier evolution model (Rounce et al., 2023). This hybrid model combines a mass balance module and a glacier dynamics module to model glaciers independently from 2000-2100 for various ensembles of Global Circulation Models (GCM) and scenarios of Shared Socio-economic Pathways (SSP).\nAccording to the published methods (Rounce et al., 2023):\n\nThe model computes the climatic mass balance (i.e., snow accumulation minus melt plus refreezing) for each surface elevation bin using a monthly time step. The model computes glacier melt using a degree-day model, accumulation using a temperature threshold, and refreezing based on the annual air temperature. Glacier geometry is updated annually using a flowline model based on the Shallow-Ice Approximation to explicitly account for glacier dynamics using a density of 900 kg m-3 for converting mass to volume.\n\nThe values used here are the output values (ice mass \\(\\pm\\) median absolute deviation) of the model for all glacier outlines of the Randolph Glacier Inventory for the Low Latitudes region downloaded from Rounce et al. (2022). Estimated initial values summarised by assessment unit are presented in Table 3.1.\n\n\n\n\nTable 3.1: Initial mass per assessment unit for the year 2000 for a representative scenario.\n\n\n\n\n\n\n\n\n\n\nThe model predicts future median ice mass values and their variability (as median absolute deviation) between 2000 and 2100 based on 12 unnamed GCMs and 5 SSP. This results in considerable uncertainty in future predictions of the total ice mass for each unit (see Figure 3.1 for an example of one unit and three scenarios).\n\n\n\n\n\n\n\n\nFigure 3.1: Estimated ice mass in Megatonnes for all glacier outlines of Mexico for three shared socioeconomic pathways. Points represent the sum of median ice mass for each outline, and the grey bars represent the uncertainty (\\(\\pm\\) median absolute deviation).\n\n\n\n\n\nThe values in the above example might overestimate the existing ice mass for smaller glacier outlines, especially in isolated and restricted regions where scale and edge effect might play significant roles (Ferrer-Paris et al., 2023). The absolute values have to be used with caution, but we will focus most analysis on range standardised measures, thus focusing more on the change relative to initial values and threshold of collapse and not on the absolute values per se.\nIce mass can decline to 0 kg, indicating the the glacier ecosystem collapses due to the disappearance of the ice substrate and the subsequent demise of its ice-dependent microbiota. For some regions the model predicts collapse in all scenarios, but other regions might retain (a reduced amount) of glacier ice beyond 2100, see Table 3.2.\n\n\n\n\nTable 3.2: Proportion of models predicting collapse before 2100 for each assessment unit.\n\n\n\n\n\n\n\n\n\n\nWe use the time series of mass projections to estimate the year of collapse (first year when mass reaches zero) for each combination of models and scenarios. For at least seven asssessment units a proportion of the dynamic ice mass balance models predict total loss of ice between 2040 and 2100, see Figure 3.2.For one unit the collapse might occurs between 2100-2102\n\n\n\n\n\n\n\n\nFigure 3.2: Histogram of year of collapse for seven assessment units (panels) and for three shared socioeconomic pathways (SSP).\n\n\n\n\n\nAlternatively, we can use the empirical cumulative distribution function of the year of collapse to estimate the proportion of models indicating collapse for each year (Figure 3.3).\n\n\n\n\n\n\n\n\nFigure 3.3: ECDF (empirical cumulative distribution function) plot of year of collapse for all models (black line) and for each shared socioeconomic pathways (SSP, labeled lines) for the assessment unit of the tropical glacier ecosystems of Mexico.\n\n\n\n\n\n\n\n\n\nFerrer-Paris, J.R., Llambí, L.D., Melfo, A., Keith, D.A., 2023. IUCN red list of ecosystem assessment: Tropical glacier ecosystem of the cordillera de mérida. EcoEvoRxiv. https://doi.org/10.32942/x2vk54\n\n\nRounce, D.R., Hock, R., Maussion, F., 2022. Global PyGEM-OGGM glacier projections with RCP and SSP scenarios, version 1. https://doi.org/10.5067/P8BN9VO9N5C7\n\n\nRounce, D.R., Hock, R., Maussion, F., Hugonnet, R., Kochtitzky, W., Huss, M., Berthier, E., Brinkerhoff, D., Compagno, L., Copland, L., Farinotti, D., Menounos, B., McNabb, R.W., 2023. Global glacier change in the 21st century: Every increase in temperature matters. Science 379, 78–83. https://doi.org/10.1126/science.abo1324",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Projection of Ice Mass Balance</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html",
    "href": "IND/suitability-model.html",
    "title": "4  Bioclimatic suitability model",
    "section": "",
    "text": "4.1 Running the GBM model\nWe fitted our own correlative model of bioclimatic suitability using a Gradient Boosting Machine (GBM) algorithm. Details of the model fitting procedure are given here and in the documented source code.",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "FORM/RS-formula.html#original-rs-formula",
    "href": "FORM/RS-formula.html#original-rs-formula",
    "title": "6  The RS formula",
    "section": "",
    "text": "Visualisation of initial and final values\nWe can use a simple plot of initial (\\(V_{0}\\)) vs. final values (\\(V_{F}\\)) to visualise the different situations that arise when measure change in time in terms of the values of RS (Figure 6.1). For risk assessment we are mostly interested in what happens in the lower right half of the plot, i.e. degradation and collapse during the period of observation. Fringe results (small improvements or initial values below the collapse threshold) should not influence the main outcomes of the assessment. However in practice, the application of the original RS formula can produce very unexpected and uninformative results, especially in the left side of the plot, where the initial values are below the collapse threshold.\n\n\n\n\n\n\n\n\nFigure 6.1: Plot of initial (\\(V_{0}\\)) vs. final values (\\(V_{F}\\)) to visualise the different situations that arise when measure change in time in terms of the values of \\(\\mathrm{RS}\\)\n\n\n\n\n\n\n\nProblems\nThere are several inconveniences with this formulation:\n\nif \\(V_{F}&gt;V_{0}\\) the value of \\(\\mathrm{OD}\\) is negative and \\(\\mathrm{RS}\\) is negative, but the magnitude can change dramatically with different values of \\(\\mathrm{MD}\\),\nif \\(V_{C}&gt;V_{0}\\) the value of \\(\\mathrm{MD}\\) is negative and \\(\\mathrm{RS}\\) is also negative,\nif both \\(V_{C}&gt;V_{0}\\) and \\(V_{F}&gt;V_{0}\\) the value of \\(\\mathrm{OD}\\) and \\(\\mathrm{MD}\\) are negative and \\(\\mathrm{RS}\\) is positive,\nif \\(|\\mathrm{OD}| &gt; |\\mathrm{MD}|\\) the value of \\(\\mathrm{RS}\\) increases disproportionatly.\n\nThis means that negative values of RS can have completely different meanings.",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>The RS formula</span>"
    ]
  },
  {
    "objectID": "FORM/RS-formula.html#conditional-formula-for-rs",
    "href": "FORM/RS-formula.html#conditional-formula-for-rs",
    "title": "6  The RS formula",
    "section": "6.2 Conditional formula for RS",
    "text": "6.2 Conditional formula for RS\nWe propose to use a conditional formula to avoid artifacts:\n\\[\n\\mathrm{RS}_{cor}=\n    \\begin{cases}\n      0, & \\text{if}\\ V_{0} ≤ V_{F} \\text{ and}\\ V_{F} &gt; V_{C}\\\\\n      \\mathrm{OD}/\\mathrm{MD}, & \\text{otherwise} \\\\\n      1, & \\text{if}\\ V_{F} ≤ V_{C} \\\\\n    \\end{cases}\n\\]\nThis formula focuses on measuring degradation, and we suggest the use of alternative measures or indices for other purposes. Although values of \\(RS&lt;0\\) could be informative for indicating recovery or improvement, we argue that their magnitude would not be informative for decision making purposes and could be confusing.",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>The RS formula</span>"
    ]
  },
  {
    "objectID": "FORM/RS-formula.html#examples-of-application-of-the-formulas",
    "href": "FORM/RS-formula.html#examples-of-application-of-the-formulas",
    "title": "6  The RS formula",
    "section": "6.3 Examples of application of the formulas",
    "text": "6.3 Examples of application of the formulas\nWe illustrate the differences between both formulas with some examples.\n\nDecline in bioclimatic suitability\nWe first explore the calculation of the RS formulas to the predictions of the bioclimatic suitability model.\nPrediction of the bioclimatic suitability model are available for four consecutive periods of 30 years each. The current conditions are summarised as mean values of the bioclimatic variables for the period 1980 to 2010, and the future conditions are calculated as mean values for the periods of 2011-2040, 2041-2070 and 2071-2100. For the future periods we have a choice of several global circulation model, socio-economic scenarios.\nWe calculate RS using the predicted suitability for the current conditions as initial value (\\(V_0\\)), and data from subsequent periods as final values (\\(V_F\\)).\nWe explore different collapse thresholds (\\(V_{C}\\)) based on the confusion matrix of the predictions under current conditions and the observed or known distribution of glacier outlines. We denote this estimate of relative severity as \\(RS_{bcs}^{CT=acc}\\), when the collapse threshold is calculated as the maximum accuracy cut-off value of the confusion matrix, and \\(RS_{bcs}^{CT=ess}\\), when the collapse threshold is calculated with the cut-off value of equal sensitivity and specificity of the confusion matrix.We also explored a third cut-off value (Positive predictive value, \\(ppv\\)), but this often resulted in high threshold values and extremely high RS values (Figure 9.3).\n\nRuwenzori\nWe focus initially in the case of the Tropical Glacier Ecosystems of the Ruwenzori mountains in Africa. This is a small region and we have calculated bioclimatic suitability for 11 raster cells overlaping with glacier outlines.\nWe show here the calculation using the suitability values for future climatic conditions based on one combination of global circulation model and scenario (mri-esm2-0, ssp126) for the period 2041-2070.\n\n\n\n\n\n\nThis example highlights several problems with the original formula when the value of \\(MD\\) and \\(RS\\) are negative, or when \\(MD\\) is very close to zero and how these problems are resolved using the conditional formula. We can visualise these data points in an interactive plot (Figure 6.2).\n\n\n\n\n\n\n\n\nFigure 6.2: Plot of initial (\\(V_{0}\\)) vs. final values (\\(V_{F}\\)) for the T.G.E. of Ruwenzori.\n\n\n\n\n\n\nKilimanjaro\nWe perform the same calculations for the Tropical Glacier Ecosystems of Kilimanjaro in Africa. This is also a small region and we have calculated bioclimatic suitability for 10 raster cells overlaping with glacier outlines.\nWe use the same combination of model, scenario and future period (mri-esm2-0, ssp126, 2041-2070) with the same criterion for threshold selection.\n\n\n\n\n\n\nIn this unit, the same criterion for threshold selection results in a much higher collapse threshold, but we also see examples of increases in the suitability index due to anomalies for this time period in the underlying climate data for this region (Figure 6.3).\n\n\n\n\n\n\n\n\nFigure 6.3: Plot of initial (\\(V_{0}\\)) vs. final values (\\(V_{F}\\)) for the T.G.E. of Kilimanjaro.\n\n\n\n\n\n\n\nRelative severity of decline in ice mass\nThe data from the Dynamic Ice Mass Balance model is provided for each glacier outline in one-year intervals, each assessment unit has multiple glacier outlines of different size and therefore different initial ice mass.\nWe calculate RS using the predicted median ice mass of the year 2000 as initial value, and data from subsequent years (2001 to 2100) as final values, and use a collapse threshold of \\(0 kg\\) of ice. We use the median absolute deviation to calculate a minimum and a maximum interval for the values of \\(RS\\).\n\n\nWe denote this estimate of relative severity as \\(RS_{ice}^{CT=0}\\).\n\nKilimanjaro\nThe Figure 6.4 shows the calculation of \\(\\mathrm{RS}_{ice}^{CT=0}\\) using the original formula for a selection of glacier outlines (sites) in the assessment unit of Kilimanjaro.\n\n\n\n\n\n\n\n\nFigure 6.4: Time series of RS values for the ice mass indicator variable for the T.G.E. of Kilimanjaro. We use here data for the first 51 years of the time series calculated from one unnamed model, one scenario (SSP1 2.6) and four selected glacier outline units identified by the RGI 6.0 id. The line represent the best estimate of RS based on median ice mass predictions, and the shaded area represent a uncertainty interval based on the median absolute deviation of ice mass predictions.\n\n\n\n\n\nGiven that the collapse threshold is also the minimum value of ice possible, the original formula does not produce values higher than one, but some models predict an increases in ice mass at the start of the time series for some glacier outlines, and this will result in negative values (below the dashed line).",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>The RS formula</span>"
    ]
  },
  {
    "objectID": "FORM/mean-RS-formula.html#overall-rs",
    "href": "FORM/mean-RS-formula.html#overall-rs",
    "title": "7  Average RS",
    "section": "",
    "text": "Choice of formula\nAggregating unbounded \\(\\mathrm{RS}_i\\) values can be problematic. In this table we calculate mean values for different thresholds and time frames for two assessment units considering one model and scenario combination. In both cases we see a clear increasing trend, but the values of the original formula are clearly influenced by the magnitude of the extreme negative or positive values of the underlying units of observation.\n\n\n\n\n\n\nWith the original formula, the interpretation of negative values or values above one would be problematic. The conditional formula guarantees that the mean of RS will be between 0 and 1 and thus can be clearly interpreted in terms of the overall magnitude of the degradation.\n\n\nTotal loss for the assessment unit\nFor the indicator variable of ice mass we have a physical quantity and the total ice mass of the assessment unit is the sum of the ice mass of each observation unit (glacier outlines).\nThus it is possible to calculate RS for the whole unit is by calculating the sum of the indicator variable first and then applying the RS formula. This is equivalent to calculating the weighted arithmetic mean as above.\n\n\n\n\n\n\n\n\n\n\n\nVariability within assessment unit\nCalculating relative severity for each outline might be misleading because the units differ in initial ice mass and contribute unequally to the total.\nWe can clearly see how different glaciers contribute to the total, and that for some periods of time the total amount is influence by several small glaciers, and in other periods it is influence by one large unit contributing most of the mass.\nIn this case, the calculation of RS for each outline is not informative unless we combine them with a weight related to their initial mass contribution.\n\n\n\n\n\n\n\n\n\nIndeed the weighted mean of the RS values of individual glacier outlines is equal to the RS of the total ice mass for the whole assessment unit.\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] stringr_1.5.1   ggpubr_0.6.0    purrr_1.0.2     htmltools_0.5.7\n[5] DT_0.31         ggforce_0.4.1   readr_2.1.4     ggplot2_3.4.4  \n[9] dplyr_1.1.4    \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.4      xfun_0.41         bslib_0.6.1       htmlwidgets_1.6.4\n [5] rstatix_0.7.2     tzdb_0.4.0        vctrs_0.6.5       tools_4.3.1      \n [9] crosstalk_1.2.1   generics_0.1.3    parallel_4.3.1    tibble_3.2.1     \n[13] fansi_1.0.6       pkgconfig_2.0.3   lifecycle_1.0.4   compiler_4.3.1   \n[17] farver_2.1.1      munsell_0.5.0     carData_3.0-5     sass_0.4.8       \n[21] yaml_2.3.8        pillar_1.9.0      car_3.1-2         crayon_1.5.2     \n[25] jquerylib_0.1.4   tidyr_1.3.0       ellipsis_0.3.2    MASS_7.3-60      \n[29] cachem_1.0.8      abind_1.4-5       tidyselect_1.2.0  digest_0.6.33    \n[33] stringi_1.8.3     labeling_0.4.3    cowplot_1.1.1     polyclip_1.10-6  \n[37] rprojroot_2.0.4   fastmap_1.1.1     grid_4.3.1        here_1.0.1       \n[41] colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    utf8_1.2.4       \n[45] broom_1.0.5       withr_2.5.2       scales_1.3.0      backports_1.4.1  \n[49] bit64_4.0.5       rmarkdown_2.25    bit_4.0.5         ggsignif_0.6.4   \n[53] hms_1.1.3         evaluate_0.23     knitr_1.45        rlang_1.1.2      \n[57] Rcpp_1.0.11       glue_1.6.2        tweenr_2.0.2      rstudioapi_0.15.0\n[61] vroom_1.6.5       jsonlite_1.8.8    R6_2.5.1",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Average RS</span>"
    ]
  },
  {
    "objectID": "FORM/cED-formula.html#motivation-variability-in-mathrmrs_i-values",
    "href": "FORM/cED-formula.html#motivation-variability-in-mathrmrs_i-values",
    "title": "8  The cED formula",
    "section": "",
    "text": "Loss of ice mass in Kilimanjaro\nGiven the nature of ice mass as a prediction of a physical measure, we need to weight the RS values of individual glacier outlines.\nIf we look at the example of the T.G.E. Kilimanjaro, for one combination of model and scenario and the year 2040, we have following values of \\(\\mathrm{RS}_{i}\\):\n\n\n\n\n\n\nSites with high RS but low initial ice mass will contribute less to the average RS, but nonetheless indicate localised high rates of degradation.\n\n\nDecline in bioclimatic suitability\nIn the case of the bioclimatic suitability model we are using spatial units with the same area and the index of suitability is not a direct measure of physical properties of the ecosystem. Thus we use the same weights for all sites. We can calculate complementary summary statistics (e.g. median and quantiles) to represent the spatial variability in values of \\(\\mathrm{RS}_{i}\\) in an assessment unit.\nFor small assessment units the spatial sample size for the calculation of \\(\\mathrm{RS}_{i}\\) is small and values tend to be relatively similar. Differences can be visualised conveniently with boxplots.\n\n\n\n\n\n\n\n\nFigure 8.1: Box and whisker plots of the \\(RS_{bcs}^{acc}\\) values for the Tropical Glacier Ecosystem of Ruwenzori. The middle line represent the location of the median and the box include the distribution from first to third quartile, the location of the mean (equal to \\(\\overline{\\mathrm{RS}}\\)) is marked with an X symbol.\n\n\n\n\n\nFor larger sampling units we can see more complex distributions of \\(\\mathrm{RS}_{i}\\) values. In the case of the Cordilleras Norte de Peru we have more than thousand raster cells with values of relative severity. Histograms of the relative severity values show a wide spread of value in one selected future period, with most cell in the 75 - 100 % interval, but still many cell in the lowest quartile. This is reflected in the difference between mean and median RS values.\n\n\n\n\n\n\n\n\nFigure 8.2: Histogram of the \\(RS_{cor}\\) values for the Tropical Glacier Ecosystem of the Cordilleras Norte de Peru using the maximum accuracy threshold.",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>The cED formula</span>"
    ]
  },
  {
    "objectID": "FORM/cED-formula.html#the-cumulative-extent-of-decline",
    "href": "FORM/cED-formula.html#the-cumulative-extent-of-decline",
    "title": "8  The cED formula",
    "section": "8.2 The Cumulative Extent of Decline",
    "text": "8.2 The Cumulative Extent of Decline\nThe cumulative extent of Decline can be calculated as follows: \\[\n\\mathrm{cED}(x) = \\frac{\\sum \\begin{cases}\n      w_{i}, & \\text{if}\\ \\mathrm{RS}_{i} ≥ x\\\\\n      0, & \\text{if}\\ \\mathrm{RS}_{i} &lt; x \\\\\n    \\end{cases}}{\\sum_{i=1}^{n} w_{i}}\n\\]\nusing the values of \\(\\mathrm{RS}_{i}\\) and \\(w_i\\) defined before.\n\ncED for decline in ice mass\nWe can use these values to calculate \\(ED_{RS≥x}\\) as a weighed empirical distribution function:\n\n\n# A tibble: 20 × 2\n        x    cED\n    &lt;dbl&gt;  &lt;dbl&gt;\n 1 0      1     \n 2 0.0526 1     \n 3 0.105  1     \n 4 0.158  1     \n 5 0.211  0.993 \n 6 0.263  0.993 \n 7 0.316  0.993 \n 8 0.368  0.348 \n 9 0.421  0.348 \n10 0.474  0.348 \n11 0.526  0.321 \n12 0.579  0.321 \n13 0.632  0.284 \n14 0.684  0.217 \n15 0.737  0.0581\n16 0.789  0.0581\n17 0.842  0.0581\n18 0.895  0.0581\n19 0.947  0     \n20 1      0     \n\n\n\n\n\n\n\n\n\n\n\ncED for bioclimatic suitability\nWe can use a similar approach to calculate the value of \\(cED\\) for the decline in bioclimatic suitability.\nWe use the data from T.G.E. of Ecuador for one combination of model and scenario and compare three future periods.\nThe shape of the histogram changes in time, with an initial increase followed by a slight decrease in mean and median values.\n\n\n\n\n\n\n\n\nFigure 8.3: Histogram of the \\(RS_{cor}\\) values for the Tropical Glacier Ecosystem of Cordilleras de Colombia using the maximum accuracy threshold.\n\n\n\n\n\nAlthough there is now a large number of cell with very high values of relative severity, this still does not represent a majority of the extent of the ecosystem. We can use an alternative visualisation to make this more explicit:\n\nwe will first flip the coordinates of the histogram,\nthen count the cummulative number of cells starting with the highest relative severity values,\nwe express this value as a propotion of the total extent of the assessment unit.\n\nIn this version we have flipped the coordinates of the plot used above for the ice mass of Kilimanjaro\n\n\n\n\n\n\n\nFigure 8.4: Comparing the histogram of the \\(RS_{cor}\\) values with a modified empirical cumulative distriution function for the Tropical Glacier Ecosystem of Cordilleras de Colombia using the maximum accuracy threshold.\n\n\n\n\n\nThis arrangement allows to read the cummulative extent by different thresholds of relative severity. For example, there ecosystem extent with \\(RS ≥ 0.75\\) increases from less than 40% in the first period to more than 50 %, and the extent with \\(RS ≥ 0.25\\) increases from nearly 65% to almost 75%.",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>The cED formula</span>"
    ]
  },
  {
    "objectID": "FORM/cED-formula.html#area-under-the-ced-curve",
    "href": "FORM/cED-formula.html#area-under-the-ced-curve",
    "title": "8  The cED formula",
    "section": "8.3 Area under the cED curve",
    "text": "8.3 Area under the cED curve\n\\[\n\\mathrm{AUC}_{\\mathit{cED}}=\\int_{0}^{1} \\mathrm{cED}(x)\\,dx \\approxeq \\overline{\\mathrm{RS}}\n\\]\nWhich is probably related to the LOTUS?\n\n\\(\\mathrm{AUC}_{\\mathit{cED}}\\) for loss of ice mass\nWhen we calculate \\(cED_{x}\\) for multiple years we can see a change in the shape of the curve.\n\nd &lt;- RSvals %&gt;%\n    filter(year %in% c(2040,2070,2100))\n\nEDs &lt;- d %&gt;%\n  group_by(year) %&gt;%\n  group_modify( ~ cED_w(\n    RS=.x$RS,\n    weights=.x$w))\nggplot(EDs) + \n  geom_step(aes(x=x, y=ED, group=year,colour=factor(year))) +\n  ylab(expression(ED[RS&gt;=x])) +\n  ylim(0,1)+\n  xlab(\"x\")\n\nThis figure shows a large increase in values of \\(RS≥0.5\\) between 2040 and 2070 and then an increase of values of \\(RS≥0.75\\) between 2070 and 2100.\n\n\n\\(\\mathrm{AUC}_{\\mathit{cED}}\\) for decline in suitability\nWe can flip the coordinates and collapse the panels to actually superinpose these curves for a quick overview of the increase in extent for each value of relative severity :\n\n\n\n\n\n\n\n\nFigure 8.5: Comparison of the modified empirical cumulative distribution function of the \\(RS_{cor}\\) values for the Tropical Glacier Ecosystem of Cordilleras de Colombia .\n\n\n\n\n\nWe see that for this combination of model, scenario and threshold, there is an increase in the extent of high severity values between the first and second period, but the distribution does not change much between the second and third period.\n\n\n\n\n\n\n\n\nFigure 8.6: Comparison of the modified empirical cumulative distribution function of the \\(RS_{cor}\\) values for the Tropical Glacier Ecosystem of Cordilleras de Colombia .\n\n\n\n\n\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] stringr_1.5.1   ggpubr_0.6.0    purrr_1.0.2     htmltools_0.5.7\n[5] DT_0.31         ggforce_0.4.1   readr_2.1.4     ggplot2_3.4.4  \n[9] dplyr_1.1.4    \n\nloaded via a namespace (and not attached):\n [1] gtable_0.3.4      xfun_0.41         bslib_0.6.1       htmlwidgets_1.6.4\n [5] rstatix_0.7.2     tzdb_0.4.0        vctrs_0.6.5       tools_4.3.1      \n [9] crosstalk_1.2.1   generics_0.1.3    parallel_4.3.1    tibble_3.2.1     \n[13] fansi_1.0.6       pkgconfig_2.0.3   lifecycle_1.0.4   compiler_4.3.1   \n[17] farver_2.1.1      munsell_0.5.0     carData_3.0-5     sass_0.4.8       \n[21] yaml_2.3.8        pillar_1.9.0      car_3.1-2         crayon_1.5.2     \n[25] jquerylib_0.1.4   tidyr_1.3.0       ellipsis_0.3.2    MASS_7.3-60      \n[29] cachem_1.0.8      abind_1.4-5       tidyselect_1.2.0  digest_0.6.33    \n[33] stringi_1.8.3     labeling_0.4.3    cowplot_1.1.1     polyclip_1.10-6  \n[37] rprojroot_2.0.4   fastmap_1.1.1     grid_4.3.1        here_1.0.1       \n[41] colorspace_2.1-0  cli_3.6.2         magrittr_2.0.3    utf8_1.2.4       \n[45] broom_1.0.5       withr_2.5.2       scales_1.3.0      backports_1.4.1  \n[49] bit64_4.0.5       rmarkdown_2.25    bit_4.0.5         ggsignif_0.6.4   \n[53] hms_1.1.3         evaluate_0.23     knitr_1.45        rlang_1.1.2      \n[57] Rcpp_1.0.11       glue_1.6.2        tweenr_2.0.2      rstudioapi_0.15.0\n[61] vroom_1.6.5       jsonlite_1.8.8    R6_2.5.1",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>The cED formula</span>"
    ]
  },
  {
    "objectID": "RS/time-series.html#loss-of-ice-mass",
    "href": "RS/time-series.html#loss-of-ice-mass",
    "title": "9  Temporal change in Relative Severity",
    "section": "",
    "text": "We calculate RS using the predicted ice mass of the year 2000 as initial value, and data from subsequent years (2001 to 2100) as final values, and a collapse threshold of \\(0 \\mathrm{kg}\\).  Given that the collapse threshold is also the minimum value of ice possible, and that increases in ice mass are low in magnitude and limited to the start of the time series, we can use the original RS formula. An example of these calculations is given in Figure 6.4.We denote this estimate of relative severity as \\(RS_{ice}^{CT=0}\\).\n\nAverage RS time series\nUsing the equation for average RS, we can create time series of \\(\\overline{\\mathrm{RS}}\\) for each assessment unit.\n\n\n\n\n\n\n\n\nFigure 9.1: Time series of average RS values for the ice mass indicator variable for all assessment units. We use here data from the 100 years time series calculated for one scenario (SSP2-4.5), and combined median and median absolute deviation (based on 50 replicates per model) for all 12 models. The line represent the best estimate and the shaded area represent the interval between aggregated min and max values for each year.\n\n\n\n\n\nThe curves indicate an increase of RS, and in some units the maximum value of 1 is attained, indicating ecosystem collapse (red sections of the curve). Certain thresholds could be used to indicate increasing levels of degradation before collapse. For example, a threshold of 0.8 (80% of the maximum value of RS) could be indictive of widespread and very high degradation. The use of these thresholds could be informative to determine the expected tempo of the process of ecosystem collapse.\n\n\n\n\n\n\n\n\nFigure 9.2: Histogram of years when thresholds of very high degradation and collapse are reached.\n\n\n\n\n\nFor example if we compare the years when a model predicts very high degradation and the year when it predicts collapse Figure 9.2, we can see that the gap between both milestones can be as short as 15 years (for Puncak Jaya and Mount Kenia) or as long as half a century (for Mexico), see table Table 9.1.\n\n\n\n\nTable 9.1: Median gap between the year when very high degradation is reached and the year of collapse. Based on the values shown in Figure 9.2.",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Temporal change in Relative Severity</span>"
    ]
  },
  {
    "objectID": "RS/time-series.html#degradation-of-bioclimatic-suitability",
    "href": "RS/time-series.html#degradation-of-bioclimatic-suitability",
    "title": "9  Temporal change in Relative Severity",
    "section": "9.2 Degradation of bioclimatic suitability",
    "text": "9.2 Degradation of bioclimatic suitability\nGiven that both initial and final values of suitability can be below these thresholds, and that future suitability predictions can be well above current values, we use the conditional RS formula for these estimates of RS.\n\n\n\n\n\n\n\n\nFigure 9.3: Mean relative severity (RS) of decline in bioclimatic suitability for the assessment unit of the T.G.E. of Ecuador for five global circulation models (points), and three different timeframes (columns), future scenarios (rows) and collapse thresholds (x axis) based on threshold of the confusion matrix ( \\(acc\\): maximum accuracy, \\(ess\\): equal sensitivity and specificity, and \\(ppv\\): Positive predictive value).\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] htmltools_0.5.7 DT_0.31         forcats_1.0.0   tidyr_1.3.0    \n [5] readr_2.1.4     purrr_1.0.2     ggrepel_0.9.4   stringr_1.5.1  \n [9] units_0.8-5     ggplot2_3.4.4   dplyr_1.1.4    \n\nloaded via a namespace (and not attached):\n [1] sass_0.4.8        utf8_1.2.4        generics_0.1.3    stringi_1.8.3    \n [5] hms_1.1.3         digest_0.6.33     magrittr_2.0.3    evaluate_0.23    \n [9] grid_4.3.1        fastmap_1.1.1     rprojroot_2.0.4   jsonlite_1.8.8   \n[13] fansi_1.0.6       crosstalk_1.2.1   scales_1.3.0      jquerylib_0.1.4  \n[17] cli_3.6.2         rlang_1.1.2       crayon_1.5.2      ellipsis_0.3.2   \n[21] bit64_4.0.5       munsell_0.5.0     cachem_1.0.8      withr_2.5.2      \n[25] yaml_2.3.8        tools_4.3.1       parallel_4.3.1    tzdb_0.4.0       \n[29] colorspace_2.1-0  here_1.0.1        vctrs_0.6.5       R6_2.5.1         \n[33] lifecycle_1.0.4   htmlwidgets_1.6.4 bit_4.0.5         vroom_1.6.5      \n[37] pkgconfig_2.0.3   bslib_0.6.1       pillar_1.9.0      gtable_0.3.4     \n[41] glue_1.6.2        Rcpp_1.0.11       xfun_0.41         tibble_3.2.1     \n[45] tidyselect_1.2.0  rstudioapi_0.15.0 knitr_1.45        farver_2.1.1     \n[49] rmarkdown_2.25    labeling_0.4.3    compiler_4.3.1",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Temporal change in Relative Severity</span>"
    ]
  },
  {
    "objectID": "RS/spatial-aggregation.html#considerations-before-aggregation",
    "href": "RS/spatial-aggregation.html#considerations-before-aggregation",
    "title": "10  Uncertainty of models and scenarios",
    "section": "",
    "text": "Sampling units\nFor our two indicator variables we have different sample sizes per assessment unit. In the case of the dynamic ice mass balance model the units of observation are glacier outlines from the Randolph Glacier Inventory, while in the bioclimatic suitability model the units of observation are cell in a spatial grid that overlap with glacier outlines from multiple sources.\n\n\n\n\n\n\nDifferences in sample size are noticeable in one assessment units that covers areas of Peru and Chile. The national glacier inventory of Chile include more detail about different ice accumulations types, including rock glaciers, that are not represented in the global inventories.\n\n\nInterpretation of values and collapse thresholds\nThe indicator variable of ice mass is a positive variable and represents a physical measurement of mass. For this variable the collapse threshold of \\(0 kg\\) indicates complete loss of the icy substrate.\nFor the indicator variable of bioclimatic suitability we are using a probability estimated by the model that requires additional interpretation. We use a confusion matrix to calculate predictive performance of the model and decide the best cut-off value between suitable and unsuitable habitat, and use that cut-off value as an estimate of collapse threshold indicating a shift in suitability conditions.",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Uncertainty of models and scenarios</span>"
    ]
  },
  {
    "objectID": "RS/spatial-aggregation.html#rs-for-the-loss-of-ice-mass",
    "href": "RS/spatial-aggregation.html#rs-for-the-loss-of-ice-mass",
    "title": "10  Uncertainty of models and scenarios",
    "section": "10.2 RS for the loss of ice mass",
    "text": "10.2 RS for the loss of ice mass\n\n\nWarning: Removed 2424 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\nFigure 10.1: Time series of relative severity (RS) of decline in total ice mass for different assessment units (columns) and three future scenarios (rows) based on a collapse threshold of \\(0 kg\\) of ice. The points represents values calculated for 12 different global circulation models.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# A tibble: 12 × 4\n# Groups:   unit_name [12]\n   unit_name                              `2011\\n2040` `2041\\n2070` `2071\\n2100`\n   &lt;fct&gt;                                  &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;       \n 1 Puncak Jaya                            mod wide     very wide    very wide   \n 2 Kilimanjaro                            low          low          low         \n 3 Mount Kenia                            mod wide     very inter   very wide   \n 4 Ruwenzori                              low          high wide    very wide   \n 5 Mexico                                 low          high wide    very wide   \n 6 Sierra Nevada de Santa Marta           low          low          very wide   \n 7 Cordillera de Merida                   high wide    very wide    very wide   \n 8 Cordilleras de Colombia                low          very inter   very wide   \n 9 Ecuador                                low          very inter   very wide   \n10 Cordilleras Norte de Peru              high inter   very inter   very wide   \n11 Cordilleras Orientales de Peru y Boli… high inter   very inter   very wide   \n12 Volcanos de Peru y Chile               low          high wide    very wide",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Uncertainty of models and scenarios</span>"
    ]
  },
  {
    "objectID": "RS/spatial-variability.html",
    "href": "RS/spatial-variability.html",
    "title": "11  Changes in the extent of decline",
    "section": "",
    "text": "flowchart LR\n    Low[\"Low degradation\"]:::LowState\n    ModWide[\"widespread\\nmoderate\\ndegradation\\ncED(0.3)&gt;0.8\"]:::ModWideState\n    Collapsed((\"Collapsed\")):::CollapsedState\n    HighWide[\"widespread\\nhigh\\ndegradation\\ncED(0.5)&gt;0.8\"]:::HighWideState\n    HighInter[\"intermediate\\nhigh\\ndegradation\\ncED(0.5)&gt;0.5\"]:::HighInterState\n    VeryLocal[\"localised\\nvery high\\ndegradation\\ncED(0.8)&gt;0.3\"]:::VeryLocalState\n    VeryInter[\"intermediate\\nvery high\\ndegradation\\ncED(0.8)&gt;0.5\"]:::VeryInterState\n    VeryWide[\"widespread\\nvery high\\ndegradation\\ncED(0.8)&gt;0.8\"]:::VeryWideState\n  \n    Low ==\"73%\"==&gt; ModWide\n    Low --\"27%\\n&lt;br/&gt;\"--&gt; HighInter\n    ModWide ==\"58%\\n&lt;br/&gt;\"==&gt; HighWide\n    ModWide -.\"14%\\n&lt;br/&gt;\".-&gt; VeryLocal\n    ModWide --\"22%\\n&lt;br/&gt;\"--&gt; HighInter\n    HighInter --&gt; HighWide\n    VeryLocal -.-&gt; HighWide\n    HighWide ==\"46%\\n&lt;br/&gt;\"==&gt; VeryInter \n    HighWide ==\"&lt;br/&gt;48%\"==&gt; VeryWide \n    VeryInter ==&gt; VeryWide\n    VeryWide ==&gt; Collapsed\n \n    classDef LowState font-style:italic,font-weight:bold,fill:#0072B2,stroke:white\n    classDef ModWideState font-style:italic,font-weight:bold,fill:#56B4E9\n    classDef HighWideState font-style:italic,font-weight:bold,fill:#E69F00\n    classDef HighInterState font-style:italic,font-weight:bold,fill:#009E73\n    classDef VeryLocalState font-style:italic,font-weight:bold,fill:#F0E442\n    classDef VeryInterState font-style:italic,font-weight:bold,fill:#D55E00\n    classDef VeryWideState font-style:italic,font-weight:bold,fill:#CC79A7\n    classDef CollapsedState font-style:italic,font-weight:bold,fill:black,stroke:white\n\n\n\nFigure 11.1: Main trajectories towards collapse.\n\n\n\n\n\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] igraph_1.6.0  stringr_1.5.1 ggpubr_0.6.0  purrr_1.0.2   DT_0.31      \n[6] ggforce_0.4.1 readr_2.1.4   ggplot2_3.4.4 dplyr_1.1.4  \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.4        generics_0.1.3    tidyr_1.3.0       rstatix_0.7.2    \n [5] stringi_1.8.3     hms_1.1.3         digest_0.6.33     magrittr_2.0.3   \n [9] evaluate_0.23     grid_4.3.1        fastmap_1.1.1     rprojroot_2.0.4  \n[13] jsonlite_1.8.8    backports_1.4.1   fansi_1.0.6       scales_1.3.0     \n[17] tweenr_2.0.2      abind_1.4-5       cli_3.6.2         rlang_1.1.2      \n[21] polyclip_1.10-6   munsell_0.5.0     withr_2.5.2       yaml_2.3.8       \n[25] tools_4.3.1       tzdb_0.4.0        ggsignif_0.6.4    colorspace_2.1-0 \n[29] here_1.0.1        broom_1.0.5       vctrs_0.6.5       R6_2.5.1         \n[33] lifecycle_1.0.4   car_3.1-2         htmlwidgets_1.6.4 MASS_7.3-60      \n[37] pkgconfig_2.0.3   pillar_1.9.0      gtable_0.3.4      glue_1.6.2       \n[41] Rcpp_1.0.11       xfun_0.41         tibble_3.2.1      tidyselect_1.2.0 \n[45] rstudioapi_0.15.0 knitr_1.45        farver_2.1.1      htmltools_0.5.7  \n[49] labeling_0.4.3    rmarkdown_2.25    carData_3.0-5     compiler_4.3.1",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Changes in the extent of decline</span>"
    ]
  },
  {
    "objectID": "GLMM/binomial-collapse.html#proportion-of-models-predicting-collapse",
    "href": "GLMM/binomial-collapse.html#proportion-of-models-predicting-collapse",
    "title": "10  Prediction of collapse",
    "section": "10.1 Proportion of models predicting collapse",
    "text": "10.1 Proportion of models predicting collapse\n\n\n# A tibble: 12 × 4\n# Groups:   unit [12]\n   unit                                       ice   acc   ess\n   &lt;chr&gt;                                    &lt;int&gt; &lt;int&gt; &lt;int&gt;\n 1 Cordillera de Merida                        60    16    31\n 2 Cordilleras Norte de Peru                    0     3    10\n 3 Cordilleras Orientales de Peru y Bolivia     0     2     5\n 4 Cordilleras de Colombia                      0     9    15\n 5 Ecuador                                      0     0     3\n 6 Kilimanjaro                                 22     0     1\n 7 Mexico                                      22     0     1\n 8 Mount Kenia                                 65    10    19\n 9 Puncak Jaya                                 72     0    22\n10 Ruwenzori                                   47     6    11\n11 Sierra Nevada de Santa Marta                17     0     5\n12 Volcanos de Peru y Chile                     0     0     3"
  },
  {
    "objectID": "GLMM/binomial-collapse.html#binomial-glmm-of-predicted-collapse",
    "href": "GLMM/binomial-collapse.html#binomial-glmm-of-predicted-collapse",
    "title": "10  Prediction of collapse",
    "section": "10.2 Binomial GLMM of predicted collapse",
    "text": "10.2 Binomial GLMM of predicted collapse\nWe used a binomial GLMM with logit link function, using a response variable with values \\(y=1\\) when \\(RS=1\\) and \\(y=0\\) otherwise. We included fixed effects of scenarios (\\(\\mathrm{scenario}\\) with three levels) and \\(\\mathrm{time}\\), and rabdom effects of assessment unit (\\(\\mathrm{unit}\\), 15 levels). Each observation corresponds to the prediction of one global circulation model, but since models are not identified in the ice mass balance model, we threat the different models as anonymous replicates, and this implies that the effect of the model is nested within \\(\\mathrm{method}\\).\nThe variable \\(\\mathrm{method}\\) could be interpreted as a fixed effect and/or as a random effect grouping variable. Although it might be interesting to explore its interaction with unit in increasing the variability of the response (Barr et al., 2013), our primary question is whether there are significant systematic differences between the methods. So we decide to use this variable as a fixed effect and keep the model simple for interpretability:\nFull model specification in R using the glmmTMB package is as follows:\n\nmod_collapse_fixed &lt;- \n  glmmTMB(collapsed ~ time + method + scenario + (1|unit), \n       data = model_data, \n       family = binomial,\n       REML = FALSE)\n\n\n\n\n## alternative with lme4\nlibrary(lme4)\nmod_collapse_full &lt;- glmer(\n    collapsed ~ time + method + scenario + (1|unit), \n    family = binomial,\n    data = model_data) \n\nAlternative with both fixed and random, will have similar fixed effects, but could be used to measure the amount of variability attributed to methods vs. units.\n\nmod_collapse_both &lt;- \n  glmmTMB(collapsed ~ time + scenario + method + (1|unit/method), \n     data = model_data, \n     family=binomial,\n     REML=FALSE)\n\nThe AIC criterion clearly favours the model with methods as a fixed and a random grouping variable:\n\nbbmle::AICtab(mod_collapse_fixed,\n              mod_collapse_both)\n\n                   dAIC  df\nmod_collapse_both    0.0 8 \nmod_collapse_fixed 242.7 7 \n\n\n\nModel diagnostics\nModel diagnostics and residual plots look good for this model specification. According to the vignette of package DHARMa small significant effects in the residuals might be spurious due to large sample size.\n\nmod_collapse_simres&lt;-simulateResiduals(mod_collapse_both)\nplot(mod_collapse_simres)\n\n\n\n\n\n\n\n\n\n\nExplained variance\nApproximation of a \\(R^2\\) statistic for this model suggests more than 90% of the variance explained by the full model (random and fixed effects) and at least 40% explained by the fixed effects alone.\n\nMuMIn::r.squaredGLMM(mod_collapse_both)\n\n                  R2m       R2c\ntheoretical 0.4446706 0.9063561\ndelta       0.4076415 0.8308812\n\n\n\n\nModel summary\nThe summary of the model indicates significant positive effects of time and future scenarios in the proportion of model predicting collapse, as expected. For the method variable, the indirect indicator have negative effects when compared with the direct indicator, but this is only significant for the maximum accuracy threshold. We can interpret this to be the lower, more conservative or optimistic bound of the collapse threshold for this indicator.\nRandom effect of unit is larger than the random effect of methods within units.\n\nsummary(mod_collapse_both)\n\n Family: binomial  ( logit )\nFormula:          collapsed ~ time + scenario + method + (1 | unit/method)\nData: model_data\n\n     AIC      BIC   logLik deviance df.resid \n   828.7    874.9   -406.4    812.7     2368 \n\nRandom effects:\n\nConditional model:\n Groups      Name        Variance Std.Dev.\n method:unit (Intercept) 8.692    2.948   \n unit        (Intercept) 7.527    2.744   \nNumber of obs: 2376, groups:  method:unit, 36; unit, 12\n\nConditional model:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)      -11.6518     1.3951  -8.352   &lt;2e-16 ***\ntime               3.8584     0.2367  16.298   &lt;2e-16 ***\nscenarioSSP3-7.0   3.6845     0.3265  11.284   &lt;2e-16 ***\nscenarioSSP5-8.5   4.3241     0.3444  12.556   &lt;2e-16 ***\nmethodacc         -2.8023     1.4041  -1.996    0.046 *  \nmethodess          1.3094     1.3065   1.002    0.316    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\nsummary(aov(mod_collapse_both))\n\n              Df Sum Sq Mean Sq F value Pr(&gt;F)    \ntime           1  54.94   54.94  669.94 &lt;2e-16 ***\nscenario       2  15.46    7.73   94.27 &lt;2e-16 ***\nmethod         2   9.34    4.67   56.92 &lt;2e-16 ***\nunit          11  83.89    7.63   93.00 &lt;2e-16 ***\nmethod:unit   22  25.96    1.18   14.39 &lt;2e-16 ***\nResiduals   2337 191.65    0.08                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nConfidence interval of the coefficients:\n\nconfint(mod_collapse_both) \n\n                                     2.5 %      97.5 %   Estimate\n(Intercept)                     -14.386210 -8.91748820 -11.651849\ntime                              3.394395  4.32240740   3.858401\nscenarioSSP3-7.0                  3.044489  4.32446058   3.684475\nscenarioSSP5-8.5                  3.649082  4.99901838   4.324050\nmethodacc                        -5.554398 -0.05026062  -2.802329\nmethodess                        -1.251400  3.87014437   1.309372\nStd.Dev.(Intercept)|method:unit   1.979285  4.39171122   2.948296\nStd.Dev.(Intercept)|unit          1.497939  5.02513908   2.743602\n\n\n\n\nRandom effects\nThe random effects of the model give us a ranking of the proportion of models predicting collapse for each assessment unit, regardless of the method used:\n\n\n                                         (Intercept)\nCordillera de Merida                       4.3274081\nMount Kenia                                3.2727399\nPuncak Jaya                                2.4082994\nRuwenzori                                  1.9154681\nCordilleras de Colombia                    0.4295954\nCordilleras Norte de Peru                 -0.5295444\nSierra Nevada de Santa Marta              -0.6329257\nMexico                                    -0.9539617\nKilimanjaro                               -0.9539617\nCordilleras Orientales de Peru y Bolivia  -1.1297111\nEcuador                                   -2.3292119\nVolcanos de Peru y Chile                  -2.3292119\n\n\n\n\nEMmeans\n\n\nscenario = SSP1-2.6, time = 1:\n method     prob       SE  df asymp.LCL asymp.UCL\n ice    0.000412 5.43e-04 Inf  3.12e-05  0.005418\n acc    0.000025 3.65e-05 Inf  1.44e-06  0.000436\n ess    0.001525 1.89e-03 Inf  1.35e-04  0.016988\n\nscenario = SSP3-7.0, time = 1:\n method     prob       SE  df asymp.LCL asymp.UCL\n ice    0.016159 2.02e-02 Inf  1.36e-03  0.165359\n acc    0.000995 1.39e-03 Inf  6.49e-05  0.015057\n ess    0.057346 6.45e-02 Inf  5.83e-03  0.386728\n\nscenario = SSP5-8.5, time = 1:\n method     prob       SE  df asymp.LCL asymp.UCL\n ice    0.030196 3.70e-02 Inf  2.61e-03  0.270628\n acc    0.001885 2.60e-03 Inf  1.26e-04  0.027621\n ess    0.103398 1.10e-01 Inf  1.11e-02  0.542460\n\nConfidence level used: 0.95 \nIntervals are back-transformed from the logit scale \n\n\n\n\n\n\nBarr, D.J., Levy, R., Scheepers, C., Tily, H.J., 2013. Random effects structure for confirmatory hypothesis testing: Keep it maximal. Journal of Memory and Language 68. https://doi.org/10.1016/j.jml.2012.11.001",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Prediction of collapse</span>"
    ]
  },
  {
    "objectID": "GLMM/beta-RS.html#beta-distribution-glmm-of-overlinemathrmrs",
    "href": "GLMM/beta-RS.html#beta-distribution-glmm-of-overlinemathrmrs",
    "title": "11  Magnitude of degradation",
    "section": "",
    "text": "Model diagnostics\nModel diagnostics and residual plots show important deviations, there is probably some effect of the unequal sample sizes between units, as we are excluding observations with \\(RS=1\\) and these are not evenly distributed among the assessment units. Particularly, the residuals are lower for the observation with high predicted values.\n\nmod_degradation_simres&lt;-simulateResiduals(mod_degradation_dispandes)\nplot(mod_degradation_simres)\n\n\n\n\n\n\n\n\n\n\nOutliers\nWhen we examine the outliers, these are mostly unexpected low values in the T.G.E. Kilimanjaro, but these are probably related to underlying anomalies in climatic conditions in this region. In fact, when using the original formulafor the time series of the dynamic ice mass balance model there were some spurious effect of negative RS in this unit. We are using now the conditional formula of RS but there is still some unexpected structure in the residuals.\n\nmod_degradation_simres$fittedModel$frame %&gt;% slice(outliers(mod_degradation_simres))\n\n          RS time scenario method                         unit andes\n1  0.1166621    2 SSP1-2.6    acc                    Ruwenzori FALSE\n2  0.1908056    2 SSP1-2.6    acc Sierra Nevada de Santa Marta FALSE\n3  0.2202120    2 SSP1-2.6    acc Sierra Nevada de Santa Marta FALSE\n4  0.3647246    2 SSP1-2.6    ess Sierra Nevada de Santa Marta FALSE\n5  0.4837541    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE\n6  0.4999853    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE\n7  0.5723302    2 SSP1-2.6    ice    Cordilleras Norte de Peru  TRUE\n8  0.6793231    2 SSP1-2.6    ice      Cordilleras de Colombia  TRUE\n9  0.6668170    2 SSP1-2.6    ice      Cordilleras de Colombia  TRUE\n10 0.4923106    2 SSP1-2.6    ice                      Ecuador  TRUE\n11 0.6043740    2 SSP1-2.6    ice                      Ecuador  TRUE\n12 0.5666947    2 SSP1-2.6    ice                      Ecuador  TRUE\n13 0.4980398    2 SSP1-2.6    ice                      Ecuador  TRUE\n14 0.3657955    2 SSP1-2.6    ice                      Ecuador  TRUE\n15 0.3622036    2 SSP1-2.6    ice                      Ecuador  TRUE\n16 0.4327956    2 SSP1-2.6    ice                      Ecuador  TRUE\n17 0.5654804    2 SSP1-2.6    ice                      Ecuador  TRUE\n18 0.9991269    0 SSP1-2.6    ice                  Puncak Jaya FALSE\n19 0.9989429    0 SSP1-2.6    ice                  Puncak Jaya FALSE\n20 0.9867472    0 SSP1-2.6    ice                    Ruwenzori FALSE\n\n\n\n\nModel summary\nThe summary of the model indicates significant positive effects of time and future scenarios in the magnitude of RS, as expected. For the method variable, the indirect indicator have significant negative effects when compared with the direct indicator, but the effect is larger for the maximum accuracy threshold. We can interpret this to be the lower, more conservative or optimistic bound of RS for this indicator. In general, variability between units is considerably larger than variability between methods, thus we can expect all three methods to reflect general patterns, but will require closer inspection to rule out interaction with the random effects of assessment units.\n\noptions(width=120)\nsummary(mod_degradation_dispandes)\n\n Family: beta  ( logit )\nFormula:          RS ~ time + scenario + method + (1 | unit/method)\nDispersion:          ~method + andes\nData: model_data_ss\n\n     AIC      BIC   logLik deviance df.resid \n -4137.0  -4071.1   2080.5  -4161.0     1787 \n\nRandom effects:\n\nConditional model:\n Groups      Name        Variance Std.Dev.\n method:unit (Intercept) 0.3238   0.5690  \n unit        (Intercept) 0.2840   0.5329  \nNumber of obs: 1799, groups:  method:unit, 33; unit, 11\n\nConditional model:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       0.77427    0.23810    3.25  0.00115 ** \ntime              1.05534    0.02399   43.99  &lt; 2e-16 ***\nscenarioSSP3-7.0  0.71553    0.04045   17.69  &lt; 2e-16 ***\nscenarioSSP5-8.5  0.93131    0.04124   22.58  &lt; 2e-16 ***\nmethodacc        -1.35694    0.24749   -5.48 4.19e-08 ***\nmethodess        -0.62014    0.24894   -2.49  0.01274 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDispersion model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  2.33828    0.06848   34.15  &lt; 2e-16 ***\nmethodacc   -0.53841    0.07823   -6.88 5.89e-12 ***\nmethodess   -0.50491    0.08449   -5.98 2.29e-09 ***\nandesTRUE    0.49988    0.06867    7.28 3.34e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Magnitude of degradation</span>"
    ]
  },
  {
    "objectID": "GLMM/beta-RS.html#beta-distribution-glmm-of-mathrmcedx",
    "href": "GLMM/beta-RS.html#beta-distribution-glmm-of-mathrmcedx",
    "title": "11  Magnitude of degradation",
    "section": "11.2 \\(\\beta\\) distribution GLMM of \\(\\mathrm{cED}(x)\\)",
    "text": "11.2 \\(\\beta\\) distribution GLMM of \\(\\mathrm{cED}(x)\\)\nGiven that \\(\\mathrm{cED}(x)\\) represent a relative measure (proportion between 0 and 1), we can also use a beta distribution GLMM with logit link function with \\(y=\\mathrm{cED}(x)\\) for all observations where \\(\\mathrm{cED}(x)&lt;1\\).\nFirst let’s prepare the dataframe considering the filters and modification applied before:\n\ncED_model_data &lt;-\n  cED_model_data %&gt;%\n    filter(\n      method %in% valid_methods,\n      !unit %in% \"Kilimanjaro\"\n      ) %&gt;%\n    mutate(\n      method=factor(method, levels = valid_methods),\n      andes = grepl(\"Peru|Colombia|Ecuador|Merida\", unit)\n    )\n\n\n\\(\\mathrm{cED}(0.3)\\)\nJust as the model above, we included fixed effects of scenarios (\\(\\mathrm{scenario}\\) with three levels) and \\(\\mathrm{time}\\), and nested effect of \\(\\mathrm{method}\\) within each assessment unit (\\(\\mathrm{unit}\\), 15 levels) and implied nested effects of model within \\(\\mathrm{method}\\).\n\nmodel_data_ss &lt;- cED_model_data %&gt;%\n  filter(cED_30&gt;0 & cED_30&lt;1) \n\nmod_cED_30_andes &lt;- \n  glmmTMB(cED_30 ~ time + scenario + method + (1|unit/method), \n        dispformula=~method+andes, \n    data = model_data_ss, \n    family = beta_family,\n    REML=FALSE)\n\nModel diagnostics and residual plots deviate strongly, thus we do not\n\nmod_cED_simres&lt;-simulateResiduals(mod_cED_30_andes)\nplot(mod_cED_simres)\n\n\n\n\n\n\n\n\n\n\n\\(\\mathrm{cED}(0.5)\\)\n\nmodel_data_ss &lt;- cED_model_data %&gt;%\n  filter(cED_50&gt;0 & cED_50&lt;1) \n\nmod_cED_50_andes &lt;- \n  glmmTMB(cED_50 ~ time + scenario + method + (1|unit/method), \n        dispformula=~method+andes,  \n    data = model_data_ss, \n    family = beta_family,\n    REML=FALSE)\n\nModel diagnostics and residual plots deviate strongly:\n\nmod_cED_simres&lt;-simulateResiduals(mod_cED_50_andes)\nplot(mod_cED_simres)\n\n\n\n\n\n\n\n\n\n\n\\(\\mathrm{cED}(0.8)\\)\n\nmodel_data_ss &lt;- cED_model_data %&gt;%\n  filter(cED_80&gt;0 & cED_80&lt;1) \n\nmod_cED_80_andes &lt;- \n  glmmTMB(cED_80 ~ time + scenario + method + (1|unit/method), \n        dispformula=~method+andes, \n        data = model_data_ss, \n    family = beta_family,\n    REML=FALSE)\n\nModel diagnostics and residual plots deviate strongly:\n\nmod_cED_simres&lt;-simulateResiduals(mod_cED_80_andes)\nplot(mod_cED_simres)",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Magnitude of degradation</span>"
    ]
  },
  {
    "objectID": "GLMM/beta-RS.html#beta-distribution-glmm-of-mathrmauc_mathrmced",
    "href": "GLMM/beta-RS.html#beta-distribution-glmm-of-mathrmauc_mathrmced",
    "title": "11  Magnitude of degradation",
    "section": "11.3 \\(\\beta\\) distribution GLMM of \\(\\mathrm{AUC}_{\\mathrm{cED}}\\)",
    "text": "11.3 \\(\\beta\\) distribution GLMM of \\(\\mathrm{AUC}_{\\mathrm{cED}}\\)\nGiven that RS represent a relative measure (proportion between 0 and 1), we use a beta distribution GLMM with logit link function with \\(y=\\mathrm{AUC}_{\\mathrm{cED}}\\) for all observations where \\(\\mathrm{AUC}_{\\mathrm{cED}}&lt;1\\). Just as the model above, we included fixed effects of scenarios (\\(\\mathrm{scenario}\\) with three levels) and \\(\\mathrm{time}\\), and nested effect of \\(\\mathrm{method}\\) within each assessment unit (\\(\\mathrm{unit}\\), 15 levels) and implied nested effects of model within \\(\\mathrm{method}\\).\n\nmodel_data_ss &lt;- cED_model_data %&gt;%\n  filter(AUC_cED&gt;0 & AUC_cED&lt;1) \n\n\nmod_degradation_both &lt;- \n  glmmTMB(AUC_cED ~ time + scenario + method + (1|unit/method), \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_andes &lt;- \n  glmmTMB(AUC_cED ~ time + scenario + method + (1|unit/method) + (1|method:andes), \n        dispformula=~method, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_disp &lt;- \n  glmmTMB(AUC_cED ~ time + scenario + method + (1|unit/method), \n        dispformula=~method, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_dispandes &lt;- \n  glmmTMB(AUC_cED ~ time + scenario + method + (1|unit/method), \n        dispformula=~method+andes, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nThe AIC criterion favours the initial specification with all variables and without dispersion model:\n\nbbmle::AICtab(\n  mod_degradation_disp,\n  mod_degradation_dispandes,\n  mod_degradation_andes,\n  mod_degradation_both\n  )\n\n                          dAIC  df\nmod_degradation_dispandes   0.0 12\nmod_degradation_andes     143.9 12\nmod_degradation_disp      160.1 11\nmod_degradation_both      186.4 9 \n\n\n\nModel diagnostics\nModel diagnostics and residual plots look more or less ok, but there is probably some effect of the unequal sample sizes between units, as we are excluding observations with \\(RS=1\\) and these are not evenly distributed among the assessment units.\n\nmod_cED_simres&lt;-simulateResiduals(mod_degradation_dispandes)\nplot(mod_cED_simres)\n\n\n\n\n\n\n\n\n\n\nOutliers\nLet’s examine the outliers:\n\nmod_cED_simres$fittedModel$frame %&gt;% slice(outliers(mod_cED_simres))\n\n     AUC_cED time scenario method                      unit andes\n1  0.0110632    2 SSP1-2.6    ess               Mount Kenia FALSE\n2  0.2410671    2 SSP1-2.6    ess                 Ruwenzori FALSE\n3  0.0110632    2 SSP1-2.6    acc               Mount Kenia FALSE\n4  0.1266893    2 SSP1-2.6    acc                 Ruwenzori FALSE\n5  0.9289891    0 SSP1-2.6    acc      Cordillera de Merida  TRUE\n6  1.0000000    1 SSP1-2.6    ice               Puncak Jaya FALSE\n7  1.0000000    1 SSP1-2.6    ice                 Ruwenzori FALSE\n8  0.4902343    2 SSP1-2.6    ice Cordilleras Norte de Peru  TRUE\n9  1.0000000    1 SSP1-2.6    ice      Cordillera de Merida  TRUE\n10 1.0000000    1 SSP1-2.6    ice      Cordillera de Merida  TRUE\n11 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE\n12 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE\n13 1.0000000    2 SSP1-2.6    ice      Cordillera de Merida  TRUE\n14 0.4924969    2 SSP1-2.6    ice                   Ecuador  TRUE\n15 0.5024112    2 SSP1-2.6    ice                   Ecuador  TRUE\n16 0.3733117    2 SSP1-2.6    ice                   Ecuador  TRUE\n17 0.3634823    2 SSP1-2.6    ice                   Ecuador  TRUE\n18 0.4376313    2 SSP1-2.6    ice                   Ecuador  TRUE\n19 1.0000000    0 SSP3-7.0    ice               Puncak Jaya FALSE\n20 1.0000000    1 SSP5-8.5    ice      Cordillera de Merida  TRUE\n\n\n\n\nModel summary\nThe summary of the model indicates significant positive effects of time and future scenarios in the magnitude of RS, as expected. For the method variable, the indirect indicator have significant negative effects when compared with the direct indicator, but the effect is larger for the maximum accuracy threshold. We can interpret this to be the lower, more conservative or optimistic bound of RS for this indicator. In general, variability between units is considerably larger than variability between methods, thus we can expect all three methods to reflect general patterns, but will require closer inspection to rule out interaction with the random effects of assessment units.\n\noptions(width=120)\nsummary(mod_degradation_dispandes)\n\n Family: beta  ( logit )\nFormula:          AUC_cED ~ time + scenario + method + (1 | unit/method)\nDispersion:               ~method + andes\nData: model_data_ss\n\n     AIC      BIC   logLik deviance df.resid \n -7389.6  -7323.6   3706.8  -7413.6     1792 \n\nRandom effects:\n\nConditional model:\n Groups      Name        Variance Std.Dev.\n method:unit (Intercept) 0.4280   0.6542  \n unit        (Intercept) 0.3511   0.5926  \nNumber of obs: 1804, groups:  method:unit, 33; unit, 11\n\nConditional model:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)       0.93848    0.26985    3.48 0.000506 ***\ntime              1.10740    0.02499   44.31  &lt; 2e-16 ***\nscenarioSSP3-7.0  0.73008    0.04317   16.91  &lt; 2e-16 ***\nscenarioSSP5-8.5  0.93173    0.04388   21.24  &lt; 2e-16 ***\nmethodess        -0.83180    0.28541   -2.91 0.003564 ** \nmethodacc        -1.56336    0.28405   -5.50 3.71e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nDispersion model:\n            Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)  1.81310    0.06954  26.073  &lt; 2e-16 ***\nmethodess   -0.22808    0.08535  -2.672 0.007536 ** \nmethodacc   -0.29254    0.07903  -3.702 0.000214 ***\nandesTRUE    0.86508    0.06922  12.497  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Magnitude of degradation</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Barcaza, G., Nussbaumer, S.U., Tapia, G., Valdés, J., García, J.L.,\nVidela, Y., Albornoz, A., Arias, V., 2017. Glacier inventory and recent\nglacier variations in the andes of chile, south america. Annals of\nGlaciology 58. https://doi.org/10.1017/aog.2017.28\n\n\nBarr, D.J., Levy, R., Scheepers, C., Tily, H.J., 2013. Random effects\nstructure for confirmatory hypothesis testing: Keep it maximal. Journal\nof Memory and Language 68. https://doi.org/10.1016/j.jml.2012.11.001\n\n\nBland, L.M., Keith, D.A., Miller, R.M., Murray, N.J., Rodríguez, J.P.\n(Eds.), 2017. Guidelines for the application of IUCN red list of\necosystems categories and criteria. Version 1.1. IUCN International\nUnion for Conservation of Nature. https://doi.org/10.2305/iucn.ch.2016.rle.3.en\n\n\nConsortium, G., n.d. GLIMS glacier database, version 1. https://doi.org/10.7265/N5V98602\n\n\nDial, R., Ditto, J., 2020. The biogeography of the glacier biome, in:\nEncyclopedia of the World’s Biomes. https://doi.org/10.1016/B978-0-12-409548-9.12137-2\n\n\nFerrer-Paris, J.R., Keith, D.A., 2023. Trade-offs in the use of direct\nand indirect indicators of ecosystem degradation for risk assessment. https://doi.org/10.2139/ssrn.4677731\n\n\nFerrer-Paris, J.R., Llambí, L.D., Melfo, A., Keith, D.A., 2023. IUCN red\nlist of ecosystem assessment: Tropical glacier ecosystem of the\ncordillera de mérida. EcoEvoRxiv. https://doi.org/10.32942/x2vk54\n\n\nHotaling, S., Hood, E., Hamilton, T.L., 2017. Microbial ecology of\nmountain glacier ecosystems: Biodiversity, ecological connections and\nimplications of a warming climate. Environmental Microbiology 19,\n2935–2948. https://doi.org/https://doi.org/10.1111/1462-2920.13766\n\n\nHotaling, S., Wimberger, P.H., Kelley, J.L., Watts, H.E., 2020.\nMacroinvertebrates on glaciers: A key resource for terrestrial food\nwebs? Ecology 101, e02947. https://doi.org/10.1002/ecy.2947\n\n\nINAIGEM, 2018. El\ninventario nacional de glaciares: Las cordilleras glaciares del\nperú. Instituto Nacional de Investigación en Glaciares y Ecosistemas\nde Montaña.\n\n\nKeith, D.A., 2015. Assessing and managing risks to ecosystem\nbiodiversity. Austral Ecology 40, 337–346. https://doi.org/10.1111/aec.12249\n\n\nKeith, D.A., Ferrer-Paris, J.R., Nicholson, E., Kingsford, R.T. (Eds.),\n2020. IUCN global ecosystem typology 2.0: Descriptive\nprofiles for biomes and ecosystem functional groups. IUCN,\nInternational Union for Conservation of Nature. https://doi.org/10.2305/iucn.ch.2020.13.en\n\n\nKeith, D.A., Rodríguez, J.P., Rodríguez-Clark, K.M., Nicholson, E.,\nAapala, K., Alonso, A., Asmussen, M., Bachman, S., Basset, A., Barrow,\nE.G., Benson, J.S., Bishop, M.J., Bonifacio, R., Brooks, T.M., Burgman,\nM.A., Comer, P., Comín, F. a, Essl, F., Faber-Langendoen, D.,\nFairweather, P.G., Holdaway, R.J., Jennings, M., Kingsford, R.T.,\nLester, R.E., Nally, R.M., McCarthy, M.A., Moat, J., Oliveira-Miranda,\nM.A., Pisanu, P., Poulin, B., Regan, T.J., Riecken, U., Spalding, M.D.,\nZambrano-Martínez, S., 2013. Scientific foundations for an IUCN red list\nof ecosystems. PLoS ONE 8, e62111. https://doi.org/10.1371/journal.pone.0062111\n\n\nKuhn, J., Andino, P., Calvez, R., Espinosa, R., Hamerlink, L., Vie, S.,\nDangles, O., Jacobsen, D., 2011. Spatial variability in\nmacroinvertebrate assemblages along and among neighbouring equatorial\nglacier-fed streams. Freshwater Biology 56, 2226–2244. https://doi.org/10.1111/j.1365-2427.2011.02648.x\n\n\nNicholson, E., Andrade, A., Driver, A., Ferrer-Paris, J.R., Keith, D.,\nSievers, M., Stevenson, S., 2024. Beyond the headline: Roles of the red\nlist of ecosystems in implementing the kunming-montreal global\nbiodiversity framework. Nature Ecology and Evolution. https://doi.org/10.1038/s41559-023-02320-5\n\n\nRandolph Glacier Inventory Consortium, 2017. Randolph glacier inventory\n6.0. https://doi.org/10.7265/N5-RGI-60\n\n\nRaup, B., Racoviteanu, A., Khalsa, S.J.S., Helm, C., Armstrong, R.,\nArnaud, Y., 2007. The GLIMS geospatial glacier database: A new tool for\nstudying glacier change. Global and Planetary Change 56, 101–110. https://doi.org/10.1016/j.gloplacha.2006.07.018\n\n\nRounce, D.R., Hock, R., Maussion, F., 2022. Global PyGEM-OGGM glacier\nprojections with RCP and SSP scenarios, version 1. https://doi.org/10.5067/P8BN9VO9N5C7\n\n\nRounce, D.R., Hock, R., Maussion, F., Hugonnet, R., Kochtitzky, W.,\nHuss, M., Berthier, E., Brinkerhoff, D., Compagno, L., Copland, L.,\nFarinotti, D., Menounos, B., McNabb, R.W., 2023. Global glacier change\nin the 21st century: Every increase in temperature matters. Science 379,\n78–83. https://doi.org/10.1126/science.abo1324\n\n\nSagredo, E.A., Lowell, T.V., 2012. Climatology of andean glaciers: A\nframework to understand glacier response to climate change. Global and\nPlanetary Change 86-87, 101–109. https://doi.org/https://doi.org/10.1016/j.gloplacha.2012.02.010\n\n\nVeettil, Kamp, 2019. Global disappearance of tropical mountain glaciers:\nObservations, causes, and challenges. Geosciences 9, 196. https://doi.org/10.3390/geosciences9050196\n\n\nZalazar, L., Ferri, L., Castro, M., Gargantini, H., Gimenez, M., Pitte,\nP., Ruiz, L., Masiokas, M., Costa, G., Villalba, R., 2020. Spatial\ndistribution and characteristics of andean ice masses in argentina:\nResults from the first national glacier inventory. Journal of Glaciology\n66. https://doi.org/10.1017/jog.2020.55",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "A1/Mexico.html#compare-overall-rs",
    "href": "A1/Mexico.html#compare-overall-rs",
    "title": "Appendix A — T.G.E. Mexico",
    "section": "A.1 Compare overall RS",
    "text": "A.1 Compare overall RS"
  },
  {
    "objectID": "A1/Mexico.html#collapse-year-complete-loss-of-ice",
    "href": "A1/Mexico.html#collapse-year-complete-loss-of-ice",
    "title": "Appendix A — T.G.E. Mexico",
    "section": "A.2 Collapse year: complete loss of ice",
    "text": "A.2 Collapse year: complete loss of ice\n\n\n\n\n\n\n\n\nFigure A.1: ECDF (empirical cumulative distribution function) plot of year of collapse for all models (black line) and for each shared socioeconomic pathways (SSP, labeled lines).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>T.G.E. Mexico</span>"
    ]
  },
  {
    "objectID": "A1/Mexico.html#bioclimatic-suitability-model",
    "href": "A1/Mexico.html#bioclimatic-suitability-model",
    "title": "Appendix A — T.G.E. Mexico",
    "section": "A.3 Bioclimatic suitability model",
    "text": "A.3 Bioclimatic suitability model\n\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\ngbm variable importance\n\n       Overall\nbio_05 100.000\nbio_09  28.710\nbio_10  26.025\nbio_13  25.914\nbio_03  16.564\nbio_01  14.167\nbio_14  12.592\nbio_15  10.920\nbio_12  10.194\nbio_04  10.087\nbio_18   9.943\nbio_19   9.165\nbio_16   8.614\nbio_08   7.733\nbio_07   5.639\nbio_06   5.047\nbio_17   4.007\nbio_02   2.553\nbio_11   0.000",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>T.G.E. Mexico</span>"
    ]
  },
  {
    "objectID": "A1/Mexico.html#data-used-in-the-model",
    "href": "A1/Mexico.html#data-used-in-the-model",
    "title": "Appendix A — T.G.E. Mexico",
    "section": "A.4 Data used in the model",
    "text": "A.4 Data used in the model",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>T.G.E. Mexico</span>"
    ]
  },
  {
    "objectID": "A1/Kilimanjaro.html#compare-overall-rs",
    "href": "A1/Kilimanjaro.html#compare-overall-rs",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "B.1 Compare overall RS",
    "text": "B.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\n\n\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\nFigure B.1: Time series of relative severity of ice mass loss. Original RS formula.\n\n\n\n\n\n\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`)."
  },
  {
    "objectID": "A1/Kilimanjaro.html#bioclimatic-suitability-model",
    "href": "A1/Kilimanjaro.html#bioclimatic-suitability-model",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "B.2 Bioclimatic suitability model",
    "text": "B.2 Bioclimatic suitability model\n\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\ngbm variable importance\n\n       Overall\nbio_05 100.000\nbio_09  31.000\nbio_01  18.686\nbio_15  18.448\nbio_10  17.842\nbio_08  15.503\nbio_18  13.944\nbio_12  13.697\nbio_04  13.163\nbio_13  12.740\nbio_03  12.464\nbio_06   9.392\nbio_02   8.648\nbio_19   7.663\nbio_07   5.902\nbio_16   5.783\nbio_14   5.254\nbio_17   1.814\nbio_11   0.000\n\n\n\n\n\n\n\n\n\nThis is a problem, the cutoff value is very high because the model overfits!",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>T.G.E. Kilimanjaro</span>"
    ]
  },
  {
    "objectID": "A1/Kilimanjaro.html#collapse-year-complete-loss-of-ice",
    "href": "A1/Kilimanjaro.html#collapse-year-complete-loss-of-ice",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "B.3 Collapse year: complete loss of ice",
    "text": "B.3 Collapse year: complete loss of ice\n\n\n\n\n\n\n\n\nFigure B.2: ECDF (empirical cumulative distribution function) plot of year of collapse for all models (black line) and for each shared socioeconomic pathways (SSP, labeled lines).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>T.G.E. Kilimanjaro</span>"
    ]
  },
  {
    "objectID": "A1/Kilimanjaro.html#data-used-in-the-model",
    "href": "A1/Kilimanjaro.html#data-used-in-the-model",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "B.4 Data used in the model",
    "text": "B.4 Data used in the model",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>T.G.E. Kilimanjaro</span>"
    ]
  },
  {
    "objectID": "A1/Kilimanjaro.html#initial-values-vs.-final-values",
    "href": "A1/Kilimanjaro.html#initial-values-vs.-final-values",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "B.5 Initial values vs. final values",
    "text": "B.5 Initial values vs. final values\n\n\n\nR session info for this chapter\n\n\n\nR version 4.3.1 (2023-06-16)\nPlatform: aarch64-apple-darwin20 (64-bit)\nRunning under: macOS Sonoma 14.3.1\n\nMatrix products: default\nBLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib \nLAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0\n\nlocale:\n[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n\ntime zone: Australia/Sydney\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] ggpubr_0.6.0   readr_2.1.4    gbm_2.1.8.1    caret_6.0-94   lattice_0.22-5\n [6] ggrepel_0.9.4  stringr_1.5.1  units_0.8-5    ggplot2_3.4.4  dplyr_1.1.4   \n\nloaded via a namespace (and not attached):\n [1] tidyselect_1.2.0     timeDate_4022.108    farver_2.1.1        \n [4] fastmap_1.1.1        pROC_1.18.5          digest_0.6.33       \n [7] rpart_4.1.23         timechange_0.2.0     lifecycle_1.0.4     \n[10] survival_3.5-7       magrittr_2.0.3       compiler_4.3.1      \n[13] rlang_1.1.2          tools_4.3.1          utf8_1.2.4          \n[16] yaml_2.3.8           data.table_1.14.10   knitr_1.45          \n[19] ggsignif_0.6.4       labeling_0.4.3       htmlwidgets_1.6.4   \n[22] bit_4.0.5            here_1.0.1           plyr_1.8.9          \n[25] abind_1.4-5          withr_2.5.2          purrr_1.0.2         \n[28] nnet_7.3-19          grid_4.3.1           stats4_4.3.1        \n[31] fansi_1.0.6          colorspace_2.1-0     future_1.33.0       \n[34] globals_0.16.2       scales_1.3.0         iterators_1.0.14    \n[37] MASS_7.3-60          cli_3.6.2            crayon_1.5.2        \n[40] rmarkdown_2.25       generics_0.1.3       rstudioapi_0.15.0   \n[43] future.apply_1.11.0  reshape2_1.4.4       tzdb_0.4.0          \n[46] splines_4.3.1        parallel_4.3.1       vctrs_0.6.5         \n[49] hardhat_1.3.0        Matrix_1.6-4         carData_3.0-5       \n[52] jsonlite_1.8.8       car_3.1-2            hms_1.1.3           \n[55] bit64_4.0.5          rstatix_0.7.2        listenv_0.9.0       \n[58] foreach_1.5.2        gower_1.0.1          tidyr_1.3.0         \n[61] recipes_1.0.8        glue_1.6.2           parallelly_1.36.0   \n[64] codetools_0.2-19     cowplot_1.1.1        lubridate_1.9.3     \n[67] stringi_1.8.3        gtable_0.3.4         munsell_0.5.0       \n[70] tibble_3.2.1         pillar_1.9.0         htmltools_0.5.7     \n[73] ipred_0.9-14         lava_1.7.3           R6_2.5.1            \n[76] rprojroot_2.0.4      vroom_1.6.5          evaluate_0.23       \n[79] backports_1.4.1      broom_1.0.5          class_7.3-22        \n[82] Rcpp_1.0.11          nlme_3.1-164         prodlim_2023.08.28  \n[85] xfun_0.41            pkgconfig_2.0.3      ModelMetrics_1.2.2.2",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>T.G.E. Kilimanjaro</span>"
    ]
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html#compare-overall-rs",
    "href": "A1/Cordillera-de-Merida.html#compare-overall-rs",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "C.1 Compare overall RS",
    "text": "C.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\n\n\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\nFigure C.1: Time series of relative severity of ice mass loss. Original RS formula.\n\n\n\n\n\n\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`)."
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html#bioclimatic-suitability-model",
    "href": "A1/Cordillera-de-Merida.html#bioclimatic-suitability-model",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "C.2 Bioclimatic suitability model",
    "text": "C.2 Bioclimatic suitability model\n\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\ngbm variable importance\n\n       Overall\nbio_05 100.000\nbio_13  37.319\nbio_10  21.668\nbio_09  19.986\nbio_03  13.529\nbio_01  12.218\nbio_18  11.926\nbio_15  11.001\nbio_19   8.392\nbio_08   6.834\nbio_07   5.525\nbio_04   5.504\nbio_16   5.451\nbio_02   5.328\nbio_12   4.329\nbio_11   4.133\nbio_17   1.949\nbio_14   1.807\nbio_06   0.000",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>T.G.E. Cordillera de Merida</span>"
    ]
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html#collapse-year-complete-loss-of-ice",
    "href": "A1/Cordillera-de-Merida.html#collapse-year-complete-loss-of-ice",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "C.3 Collapse year: complete loss of ice",
    "text": "C.3 Collapse year: complete loss of ice",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>T.G.E. Cordillera de Merida</span>"
    ]
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html#collapse-year-complete-loss-of-ice-1",
    "href": "A1/Cordillera-de-Merida.html#collapse-year-complete-loss-of-ice-1",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "C.4 Collapse year: complete loss of ice",
    "text": "C.4 Collapse year: complete loss of ice\n\n\n\n\n\n\n\n\nFigure C.2: ECDF (empirical cumulative distribution function) plot of year of collapse for all models (black line) and for each shared socioeconomic pathways (SSP, labeled lines).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>T.G.E. Cordillera de Merida</span>"
    ]
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html#data-used-in-the-model",
    "href": "A1/Cordillera-de-Merida.html#data-used-in-the-model",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "C.5 Data used in the model",
    "text": "C.5 Data used in the model",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>T.G.E. Cordillera de Merida</span>"
    ]
  },
  {
    "objectID": "A1/Colombia.html#compare-overall-rs",
    "href": "A1/Colombia.html#compare-overall-rs",
    "title": "Appendix D — T.G.E. Cordilleras de Colombia",
    "section": "D.1 Compare overall RS",
    "text": "D.1 Compare overall RS\n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`."
  },
  {
    "objectID": "A1/Colombia.html#ced-bioclimatic-suitability",
    "href": "A1/Colombia.html#ced-bioclimatic-suitability",
    "title": "Appendix D — T.G.E. Cordilleras de Colombia",
    "section": "D.2 cED bioclimatic suitability",
    "text": "D.2 cED bioclimatic suitability\n\n\n\n\n\n\n\n\n\n# A tibble: 3 × 5\n# Groups:   timeframe [3]\n  timeframe cED_30 cED_50 cED_80 AUC_cED\n  &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;\n1 2011-2040  0.545  0.386  0.114   0.393\n2 2041-2070  0.909  0.841  0.568   0.782\n3 2071-2100  0.955  0.932  0.591   0.811",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>D</span>  <span class='chapter-title'>T.G.E. Cordilleras de Colombia</span>"
    ]
  },
  {
    "objectID": "A1/Ecuador.html",
    "href": "A1/Ecuador.html",
    "title": "Appendix E — T.G.E. Ecuador",
    "section": "",
    "text": "E.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\nFigure E.1: Time series of relative severity of ice mass loss. Original RS formula.\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>E</span>  <span class='chapter-title'>T.G.E. Ecuador</span>"
    ]
  },
  {
    "objectID": "A1/Ecuador.html#compare-overall-rs",
    "href": "A1/Ecuador.html#compare-overall-rs",
    "title": "Appendix E — T.G.E. Ecuador",
    "section": "E.1 Compare overall RS",
    "text": "E.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\n\n\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\nFigure E.1: Time series of relative severity of ice mass loss. Original RS formula.\n\n\n\n\n\n\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`)."
  },
  {
    "objectID": "A1/Ecuador.html#bioclimatic-suitability-model",
    "href": "A1/Ecuador.html#bioclimatic-suitability-model",
    "title": "Appendix E — T.G.E. Ecuador",
    "section": "E.2 Bioclimatic suitability model",
    "text": "E.2 Bioclimatic suitability model\n\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\ngbm variable importance\n\n       Overall\nbio_05 100.000\nbio_13  21.889\nbio_10  17.925\nbio_01  15.491\nbio_09  13.964\nbio_03  12.887\nbio_08  10.075\nbio_15   9.592\nbio_19   8.867\nbio_04   8.815\nbio_14   8.696\nbio_11   7.847\nbio_16   6.489\nbio_18   6.184\nbio_12   5.168\nbio_07   4.348\nbio_02   1.696\nbio_17   1.570\nbio_06   0.000\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure E.2: Box and whisker plots of the \\(RS_{bcs}^{acc}\\) values for the Tropical Glacier Ecosystem of Ecuador. The middle line represent the location of the median and the box include the distribution from first to third quartile, the location of the mean is marked with an X symbol.",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>E</span>  <span class='chapter-title'>T.G.E. Ecuador</span>"
    ]
  },
  {
    "objectID": "A1/Ecuador.html#collapse-year-complete-loss-of-ice",
    "href": "A1/Ecuador.html#collapse-year-complete-loss-of-ice",
    "title": "Appendix E — T.G.E. Ecuador",
    "section": "E.3 Collapse year: complete loss of ice",
    "text": "E.3 Collapse year: complete loss of ice\nMassbalance model does not predict collapse of the ecosystem",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>E</span>  <span class='chapter-title'>T.G.E. Ecuador</span>"
    ]
  },
  {
    "objectID": "A1/Ecuador.html#data-used-in-the-model",
    "href": "A1/Ecuador.html#data-used-in-the-model",
    "title": "Appendix E — T.G.E. Ecuador",
    "section": "E.4 Data used in the model",
    "text": "E.4 Data used in the model",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>E</span>  <span class='chapter-title'>T.G.E. Ecuador</span>"
    ]
  },
  {
    "objectID": "A2/general-workflow.html#steps",
    "href": "A2/general-workflow.html#steps",
    "title": "Appendix F — General description of workflow",
    "section": "",
    "text": "Consolidate input data\n#| eval: false\nsource $HOME/proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/env/project-env.sh\ncd $WORKDIR\n## load modules for gdal functions\nmodule purge\nmodule load gdal/3.5.3-szip  r/4.2.2\n\nRscript --vanilla $SCRIPTDIR/inc/R/00-prepare-dataframe.R\n\n\nRun models for each unit\nsource $HOME/proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/env/project-env.sh\ncd $WORKDIR\n## fool qsub to send only one job\n#qsub -J 1-3:4 $SCRIPTDIR/inc/pbs/02-run-gbm-model-per-TG-unit.pbs \nqsub -J 1-16 $SCRIPTDIR/inc/pbs/02-run-gbm-model-per-TG-unit.pbs\ntree $GISOUT/$PROJECTNAME -L 2\n\n\nCalculate Relative Severity\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/03-create-output-table-for-data-upload.R\n\n\nRead mass balance model results\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/06-massbalance-model-results.R\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/07-glmm-data-summarised.R\n\n\nUpload data to cloud repository\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/10-upload-files-to-OSF.R overwrite\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/11-download-files-from-OSF.R overwrite",
    "crumbs": [
      "Appendices",
      "Code reproducibility",
      "<span class='chapter-number'>F</span>  <span class='chapter-title'>General description of workflow</span>"
    ]
  },
  {
    "objectID": "A2/general-workflow.html#alternative-with-pbs",
    "href": "A2/general-workflow.html#alternative-with-pbs",
    "title": "Appendix F — General description of workflow",
    "section": "F.2 Alternative with PBS",
    "text": "F.2 Alternative with PBS\nRun all steps in a single PBS job file\n#| eval: false\nsource $HOME/proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/env/project-env.sh\ncd $WORKDIR\nqsub $SCRIPTDIR/inc/pbs/01-run-complete-workflow.pbs",
    "crumbs": [
      "Appendices",
      "Code reproducibility",
      "<span class='chapter-number'>F</span>  <span class='chapter-title'>General description of workflow</span>"
    ]
  },
  {
    "objectID": "FORM/cED-formula.html",
    "href": "FORM/cED-formula.html",
    "title": "8  The cED formula",
    "section": "",
    "text": "8.1 Motivation: Variability in \\(\\mathrm{RS}_{i}\\) values",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>The cED formula</span>"
    ]
  },
  {
    "objectID": "TGE/units.html",
    "href": "TGE/units.html",
    "title": "1  Ecosystem description",
    "section": "",
    "text": "1.1 Classification\nWe use the IUCN Global Ecosystem Typology (Keith et al., 2020) as a reference ecosystem classification system and identify Tropical Glacier Ecosystems as a subgroup within the ecosystem functional group T6.1 Ice sheets, glaciers and perennial snowfields:\nIUCN Global Ecosystem Typology\nWe excluded transitional units (Rock glaciers, or temperate glaciers).",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "RS/time-series.html",
    "href": "RS/time-series.html",
    "title": "9  Temporal change in Relative Severity",
    "section": "",
    "text": "9.1 Loss of ice mass\nThe data from the Dynamic Ice Mass Balance model is provided in one year intervals, and we have summarise the data to provide the total value of ice mass of each assessment unit for each year.",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Temporal change in Relative Severity</span>"
    ]
  },
  {
    "objectID": "RS/spatial-aggregation.html",
    "href": "RS/spatial-aggregation.html",
    "title": "10  Uncertainty of models and scenarios",
    "section": "",
    "text": "10.1 Considerations before aggregation\nOur two indicator variable differ fundamentally in units and interpretation and we have to consider this when we aggregate the values of RS calculated from the sampling or observation units to larger assessment units. We also have to consider the choice of formula to calculate RS and the interpretation of the collapse threshold in each case.",
    "crumbs": [
      "Trajectories towards collapse",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Uncertainty of models and scenarios</span>"
    ]
  },
  {
    "objectID": "GLMM/beta-RS.html",
    "href": "GLMM/beta-RS.html",
    "title": "11  Magnitude of degradation",
    "section": "",
    "text": "11.1 \\(\\beta\\) distribution GLMM of \\(\\overline{\\mathrm{RS}}\\)\nGiven that \\(\\overline{\\mathrm{RS}}\\) represent a relative measure (proportion between 0 and 1), we use a beta distribution GLMM with logit link function with \\(y=\\overline{\\mathrm{RS}}\\) for all observations where \\(\\overline{\\mathrm{RS}}&lt;1\\). Just as the binomial GLMM, we included fixed effects of scenarios (\\(\\mathrm{scenario}\\) with three levels) and \\(\\mathrm{time}\\), and nested effect of \\(\\mathrm{method}\\) within each assessment unit (\\(\\mathrm{unit}\\), 15 levels) and implied nested effects of model within \\(\\mathrm{method}\\).\nWe prepare the data by applying the necessary filters and including a categorial variable representing Andean vs non-Andean units:\nmodel_data_ss &lt;- model_data %&gt;%\n  filter(RS &lt; 1 & RS &gt; 0, !unit %in% \"Kilimanjaro\") %&gt;%\n  mutate(\n    andes = grepl(\"Peru|Colombia|Ecuador|Merida\",unit),\n  )\nWe fit the full model, and alternative versions with modelled dispersion parameters and additional fixed effects as:\nmod_degradation_both &lt;- \n  glmmTMB(RS ~ time + scenario + method + (1|unit/method), \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_andes &lt;- \n  glmmTMB(RS ~ time + scenario + method + (1|unit/method) + (1|method:andes), \n        dispformula=~method, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_disp &lt;- \n  glmmTMB(RS ~ time + scenario + method + (1|unit/method), \n        dispformula=~method, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\n\nmod_degradation_dispandes &lt;- \n  glmmTMB(RS ~ time + scenario + method + (1|unit/method), \n        dispformula=~method+andes, \n        data = model_data_ss, \n        family=beta_family,\n        REML=FALSE)\nThe AIC criterion favours a model with the original fixed and random effect but an additional dispersion formula including method and region (Andean vs. non-Andean) :\nbbmle::AICtab(\n  mod_degradation_disp,\n  mod_degradation_dispandes,\n  mod_degradation_andes,\n  mod_degradation_both\n  )\n\n                          dAIC  df\nmod_degradation_dispandes   0.0 12\nmod_degradation_andes      38.2 12\nmod_degradation_disp       52.4 11\nmod_degradation_both      134.9 9",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Magnitude of degradation</span>"
    ]
  },
  {
    "objectID": "A1/Mexico.html",
    "href": "A1/Mexico.html",
    "title": "Appendix A — T.G.E. Mexico",
    "section": "",
    "text": "A.1 Compare overall RS",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>T.G.E. Mexico</span>"
    ]
  },
  {
    "objectID": "FORM/RS-formula.html",
    "href": "FORM/RS-formula.html",
    "title": "6  The RS formula",
    "section": "",
    "text": "6.1 Original RS formula\nThe original Relative Severity formula is given by:\n\\[\n\\mathrm{RS} =\n    \\frac{\\mathrm{OD}}{\\mathrm{MD}} =\n    \\frac{V_{0} - V_{F}}{V_{0} - V_{C}}\n\\] Where \\(V_{0}\\) is the initial value of the indicator, \\(V_{F}\\) is the final value, and \\(V_{C}\\) is the collapse threshold.",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>The RS formula</span>"
    ]
  },
  {
    "objectID": "FORM/mean-RS-formula.html",
    "href": "FORM/mean-RS-formula.html",
    "title": "7  Average RS",
    "section": "",
    "text": "7.1 Overall RS\nWe calculate the overall value of RS as a weighted arithmetic mean of \\(\\mathrm{RS}_i\\) values:\n\\[\n\\overline{RS}=\\frac{\\sum_{i=1}^{n}\\mathrm{RS}_{i} w_{i}}{\\sum_{i=1}^n w_{i}}\n\\]",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Average RS</span>"
    ]
  },
  {
    "objectID": "A2/general-workflow.html",
    "href": "A2/general-workflow.html",
    "title": "Appendix F — General description of workflow",
    "section": "",
    "text": "F.1 Steps\nSee Section F.1",
    "crumbs": [
      "Appendices",
      "Code reproducibility",
      "<span class='chapter-number'>F</span>  <span class='chapter-title'>General description of workflow</span>"
    ]
  },
  {
    "objectID": "A2/general-workflow.html#sec-workflow",
    "href": "A2/general-workflow.html#sec-workflow",
    "title": "Appendix F — General description of workflow",
    "section": "",
    "text": "Consolidate input data\n#| eval: false\nsource $HOME/proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/env/project-env.sh\ncd $WORKDIR\n## load modules for gdal functions\nmodule purge\nmodule load gdal/3.5.3-szip  r/4.2.2\n\nRscript --vanilla $SCRIPTDIR/inc/R/00-prepare-dataframe.R\n\n\nRun models for each unit\nsource $HOME/proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/env/project-env.sh\ncd $WORKDIR\n## fool qsub to send only one job\n#qsub -J 1-3:4 $SCRIPTDIR/inc/pbs/02-run-gbm-model-per-TG-unit.pbs \nqsub -J 1-16 $SCRIPTDIR/inc/pbs/02-run-gbm-model-per-TG-unit.pbs\ntree $GISOUT/$PROJECTNAME -L 2\n\n\nCalculate Relative Severity\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/03-create-output-table-for-data-upload.R\n\n\nRead mass balance model results\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/06-massbalance-model-results.R\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/07-glmm-data-summarised.R\n\n\nUpload data to cloud repository\ncd $SCRIPTDIR\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/10-upload-files-to-OSF.R overwrite\nRscript --no-restore --no-save $SCRIPTDIR/inc/R/11-download-files-from-OSF.R overwrite",
    "crumbs": [
      "Appendices",
      "Code reproducibility",
      "<span class='chapter-number'>F</span>  <span class='chapter-title'>General description of workflow</span>"
    ]
  },
  {
    "objectID": "TGE/units.html#sec-distribution",
    "href": "TGE/units.html#sec-distribution",
    "title": "1  Ecosystem description",
    "section": "1.2 Spatial distribution",
    "text": "1.2 Spatial distribution\nWe define the tropics notionally as the region between latitudes of 20 N and 20 S, and include all known glaciers from the highest summits of Puncak Jaya in Indonesia; Mount Kilimanjaro, Mount Kenya and the Rwenzori Mountains in East Africa; the Eje Volcánico Transversal of México; and tropical Andes glaciers groups of the inner tropics (including the Sierra Nevada de Santa Marta), wet outer tropics and dry outer tropics (Sagredo and Lowell, 2012; Veettil and Kamp, 2019).\nWe use available global and regional data on glacier outlines and point records to estimate the global distribution of Tropical Glacier Ecosystems. In the Randolph Glacier Inventory version 6.0 (Randolph Glacier Inventory Consortium, 2017) all tropical glaciers are includes in region Lower Latitudes. We compared these records with other global sources (Consortium, n.d.; Raup et al., 2007) and include additional point records from national glacier inventories (Barcaza et al., 2017; INAIGEM, 2018; Zalazar et al., 2020) to increase the coverage in some regions.\n\n\n\n\n\n\n\n\nFigure 1.1: Outline of spatial assessment units for Tropical Glacier Ecosystems. Each assessment unit consist of one or more spatial clusters (polygons), and each cluster includes a buffer of 25km around the glacier outlines.\n\n\n\n\nWe divided Tropical glacier ecosystems into 12 regional units considering previous classifications (Sagredo and Lowell, 2012), geographical proximity and similarity in bioclimatic conditions at different scales, see Figure 1.1. These boundaries are provisional, since our knowledge about the biota and biogeographical relationships between glaciers in different tropical regions of the world is incomplete (Dial and Ditto, 2020; Hotaling et al., 2017; Kuhn et al., 2011).\nSagredo and Lowell (2012) suggested a subdivision of tropical glaciers into four classes with different climatic profiles and a distinct separation from subtropical glaciers in the Andes. Their analysis excluded glaciers in tropical and subtropical latitudes of the southern hemisphere (between 20 and 30 degrees South) that could be considered transitional in terms of climate but are mostly classified as rock glaciers or permanent snowfields in national inventories. Based on ecological zonation and ice dynamics in these transitional regions, which differs from tropical regions, we suggest they are best addressed in a separate assessment.",
    "crumbs": [
      "Assessment units",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Ecosystem description</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#parallel-set-up",
    "href": "IND/suitability-model.html#parallel-set-up",
    "title": "3  Bioclimatic suitability model",
    "section": "3.2 Parallel set up",
    "text": "3.2 Parallel set up\nWe applied several strategies for parallelisation. For instance, we created a full dataset, but we repeat the model fitting process for each assessment unit (group of glacier outlines) using a PBS script. Within each session, we also use the doParallel library to speed up some of the steps of model fitting.\n\n# Programing environment variables\nenv_file_path &lt;- \"proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/\"\nsource(\n    sprintf(\n        \"%s/%s/env/project-env.R\",\n        Sys.getenv(\"HOME\"),\n        env_file_path\n    )\n)\ninput.dir &lt;- sprintf(\"%s/%s/OUTPUT\",gis.out,\"T6.1-tropical-glaciers-data\")\noutput.dir &lt;- sprintf(\"%s/%s/GBMmodel\",gis.out,projectname)\n\n# Read command line arguments for each copy run within a batch PBS job\nargs = commandArgs(trailingOnly=TRUE)\npick &lt;- as.numeric(args[1])",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#preparation-of-input-data",
    "href": "IND/suitability-model.html#preparation-of-input-data",
    "title": "3  Bioclimatic suitability model",
    "section": "3.3 Preparation of input data",
    "text": "3.3 Preparation of input data\nOccurrence records were selected using stratified random sampling from all the glacier outlines in tropical areas and 25 km distance buffers around glacier outlines.\n\n## Load spatial data for the group polygons and glacier points\ngrp_table &lt;- \n  read_sf(sprintf(\"%s/gisdata/trop-glacier-groups-labelled.gpkg\",input.dir)) %&gt;%\n  st_drop_geometry %&gt;%\n  transmute(id = factor(id), unit_name = group_name)\ntrop_glaciers_classified &lt;- \n  readRDS(file=sprintf(\"%s/Rdata/Inner-outer-wet-dry-glacier-classification.rds\",\n  input.dir))\nall_units &lt;- unique(grp_table$unit_name)\nslc_unit &lt;- all_units[ifelse(is.na(pick), 6, pick)]\n\nexclude &lt;- c(\"Temperate Glacier Ecosystems\", \"Famatina\", \"Norte de Argentina\", \"Zona Volcanica Central\")\n\nif (slc_unit %in% exclude) {\n  stop(\"Skipping temperate and transitional glacier ecosystems\")\n}\n\nsystem(sprintf('mkdir -p %s/%s', output.dir, str_replace_all(slc_unit, \" \", \"-\")))\n\nWe used 19 bioclimatic variables from the CHELSA dataset representing climatological mean values for present conditions (1981-2010) as predictor variables. Eight variables were excluded from the model due to high correlation to other variables. Variables were centered and scaled to zero mean and unit variance.\n\n# Read the data extracted from the raster files for each polygon, and saved into a Rdata file.\n\nrda.file &lt;- sprintf(\"%s/current-bioclim-data-all-groups.rda\",output.dir)\nif (file.exists(rda.file)) {\n   load(rda.file)\n} else {\n   stop(\"input_raster_data is missing\")\n}\n\nWe applied a first partition of the data by withhold the occurrence records of the target assessment unit for final model evaluation of prediction performance of the model (target partition) and the rest of the occurrence records were used for model fitting (modeling partition). Random subsets of the modeling partition were divided in calibration (80%) and test partitions (20%) for tuning of model parameters (number of trees, interaction depth, shrinkage and minimum number of observations per node) using cross validation.\n\n# Exclude low elevations\ninput_data &lt;- input_raster_data %&gt;%\n   tibble %&gt;%\n   mutate(id = factor(id)) %&gt;%\n   left_join(grp_table, by = \"id\") %&gt;%\n   filter(\n      !unit_name %in% slc_unit,\n      unit_name %in% all_units,\n      elevation_1KMmd &gt; 3500\n      ) %&gt;%\n  mutate(andes = grepl(\"Peru|Colombia|Ecuador\",unit_name))\n\ntt &lt;- table(input_data$id)\n\nsample_size &lt;- case_when(\n  slc_unit %in% \"Kilimanjaro\" ~ 5000L,\n  TRUE ~ 10000L\n)\nif (!grepl(\"Peru|Colombia|Ecuador\",slc_unit)) {\n  prob &lt;- if_else(input_data$glacier,5,.5)*if_else(input_data$andes,1,3)*(sum(tt)/tt[input_data$id])\n} else {\n  prob &lt;- if_else(input_data$glacier,5,.5)*(sum(tt)/tt[input_data$id])\n}\n\ntraining &lt;- input_data %&gt;%\n   slice_sample(n=sample_size, weight_by = prob) %&gt;%\n   dplyr::select(glacier,starts_with(\"bio_\")) %&gt;%\n   mutate(glacier=factor(if_else(glacier,\"G\",\"N\")))\n\ntesting &lt;- input_raster_data %&gt;%\n   tibble %&gt;%\n   mutate(id = factor(id)) %&gt;%\n   left_join(grp_table, by = \"id\") %&gt;%\n   filter(unit_name %in% slc_unit, elevation_1KMmd&gt;3500) %&gt;%\n   mutate(glacier = factor(if_else(glacier,\"G\",\"N\")))",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#tune-gbm-model",
    "href": "IND/suitability-model.html#tune-gbm-model",
    "title": "3  Bioclimatic suitability model",
    "section": "3.4 Tune GBM model",
    "text": "3.4 Tune GBM model\nWe fitted the GBM model for classification (two classes: glacier or not-glacier) using a bernoulli error distribution.\nModel tuning was based on some suggestions from https://topepo.github.io/caret/model-training-and-tuning.html#metrics\n\nctrl &lt;- trainControl(\n   method = \"cv\",\n   number = 10\n)\n\nfitControl &lt;- trainControl(method = \"repeatedcv\",\n                           number = 10,\n                           repeats = 10,\n                           ## Estimate class probabilities\n                           classProbs = TRUE,\n                           ## Evaluate performance using \n                           ## the following function\n                           summaryFunction = twoClassSummary)\n\ntuneGrid &lt;- expand.grid(\n   n.trees = c(50, 75, 100, 125, 150, 200),\n   interaction.depth = (1:5),\n   shrinkage = c(0.05, 0.1, 0.5),\n   n.minobsinnode = c(5, 7, 10, 12)\n)",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#run-gbm-per-region",
    "href": "IND/suitability-model.html#run-gbm-per-region",
    "title": "3  Bioclimatic suitability model",
    "section": "3.5 Run GBM per region",
    "text": "3.5 Run GBM per region\nNow we can run the GBM for each group using data from other groups and evaluate the predictive performance of the final model on the target partition.\nHere we use a parallel cluster, see https://topepo.github.io/caret/parallel-processing.html.\n\n## Register cluster for parallel processing\ncl &lt;- makeCluster(detectCores()-1)\nregisterDoParallel(cl)\n\nmodel &lt;- caret::train(\n   glacier ~ .,\n   data = training,\n   method = 'gbm',\n   distribution=\"bernoulli\",\n   preProcess = c(\"center\", \"scale\"),\n   trControl = fitControl,\n   tuneGrid = tuneGrid,\n   ## Specify which metric to optimize\n   metric = \"ROC\",\n   verbose = TRUE\n)\n\n## stop parallel cluster\nstopCluster(cl)\n\nAnd we can inspect the final model with:\n\nmodel\nplot(model)",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#evaluate-predictive-performance",
    "href": "IND/suitability-model.html#evaluate-predictive-performance",
    "title": "3  Bioclimatic suitability model",
    "section": "3.6 Evaluate predictive performance",
    "text": "3.6 Evaluate predictive performance\nWe calculate the model prediction at the testing and training locations for model evaluation and also save model, training and testing subsets for further processing.\n\ntest.features = testing %&gt;% dplyr::select(starts_with(\"bio_\"))\ntest.target = testing %&gt;% pull(glacier)\n\nrda.results &lt;- sprintf(\n   '%s/%s/gbm-model-current.rda',\n   output.dir,\n   str_replace_all(slc_unit,\" \",\"-\")\n   )\n\n\npredictions = predict(model, newdata = test.features, type='prob')\ntesting$IV &lt;- predictions[,\"G\"]\n\npredictions = predict(model,  type='prob')\ntraining$IV &lt;- predictions[,\"G\"]\n\nsave(file=rda.results,model,training,testing,slc_unit )",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#prediction-and-projection",
    "href": "IND/suitability-model.html#prediction-and-projection",
    "title": "3  Bioclimatic suitability model",
    "section": "3.7 Prediction and projection",
    "text": "3.7 Prediction and projection\nWe used the final fitted model to predict the suitability in the present timeframe (1981-2010) and future timeframes (2011-2040 and 2041-2071). We considered uncertainty due to climate change projections (five general circulation models and three representative pathways), and due to the choice of cut-off values to classify predicted suitability into binary score (glacier/non-glacier):\n\nmodeled prevalence is closest to observed prevalence\nmaximum sum of the sensitivity (true positive rate) and specificity (true negative rate),\nequal sensitivity and specificity\n\nWe summarised the outcomes for each combination of models, pathways and cut-off values and calculated relative severity of each outcome in two ways.",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "GLMM/binomial-collapse.html",
    "href": "GLMM/binomial-collapse.html",
    "title": "10  Prediction of collapse",
    "section": "",
    "text": "10.1 Proportion of models predicting collapse\n# A tibble: 12 × 4\n# Groups:   unit [12]\n   unit                                       ice   acc   ess\n   &lt;chr&gt;                                    &lt;int&gt; &lt;int&gt; &lt;int&gt;\n 1 Cordillera de Merida                        60    16    31\n 2 Cordilleras Norte de Peru                    0     3    10\n 3 Cordilleras Orientales de Peru y Bolivia     0     2     5\n 4 Cordilleras de Colombia                      0     9    15\n 5 Ecuador                                      0     0     3\n 6 Kilimanjaro                                 22     0     1\n 7 Mexico                                      22     0     1\n 8 Mount Kenia                                 65    10    19\n 9 Puncak Jaya                                 72     0    22\n10 Ruwenzori                                   47     6    11\n11 Sierra Nevada de Santa Marta                17     0     5\n12 Volcanos de Peru y Chile                     0     0     3",
    "crumbs": [
      "Compare results from different indicators",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Prediction of collapse</span>"
    ]
  },
  {
    "objectID": "index.html#citation-information",
    "href": "index.html#citation-information",
    "title": "Environmental degradation and collapse of Tropical Glacier Ecosystems",
    "section": "Citation information",
    "text": "Citation information\nThis document is a supplement to Ferrer-Paris and Keith (2023).",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#reproducibility",
    "href": "index.html#reproducibility",
    "title": "Environmental degradation and collapse of Tropical Glacier Ecosystems",
    "section": "Reproducibility",
    "text": "Reproducibility\nThe full repository and its documentation are available at:\n\nFerrer-Paris, J. R., & Keith, D. (2023, December 23). Environmental suitability model for Tropical Glacier Ecosystems. Retrieved from osf.io/hp8bs",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "index.html#related-project-components",
    "href": "index.html#related-project-components",
    "title": "Environmental degradation and collapse of Tropical Glacier Ecosystems",
    "section": "Related project components",
    "text": "Related project components\nThis document is part of a series of outputs related to the assessment of risk of collapse of tropical glacier ecosystems. https://osf.io/792qb/\nThese include an assessment of the risk of collapse of the tropical glacier of the Cordillera de Mérida in Venezuela (Ferrer-Paris et al., 2023).\n\n\n\n\nFerrer-Paris, J.R., Keith, D.A., 2023. Trade-offs in the use of direct and indirect indicators of ecosystem degradation for risk assessment. https://doi.org/10.2139/ssrn.4677731\n\n\nFerrer-Paris, J.R., Llambí, L.D., Melfo, A., Keith, D.A., 2023. IUCN red list of ecosystem assessment: Tropical glacier ecosystem of the cordillera de mérida. EcoEvoRxiv. https://doi.org/10.32942/x2vk54",
    "crumbs": [
      "Introduction"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#running-the-gbm-model",
    "href": "IND/suitability-model.html#running-the-gbm-model",
    "title": "4  Bioclimatic suitability model",
    "section": "",
    "text": "Note\n\n\n\nThis research includes computations using the computational cluster Katana supported by Research Technology Services at UNSW Sydney. https://doi.org/10.26190/669x-a286\nThe full code makes use of multiple strategies for speeding up calculations in parallel, see Section F.1 for a full description of the workflow. A simplified version of the code is shown here for reference, but not executed during rendering of this document.\n\n\n\nLoad libraries\nFirst we setup the required libraries.\n\nrequire(dplyr)\n\nLoading required package: dplyr\n\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nrequire(sf)\n\nLoading required package: sf\n\n\nLinking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE\n\nrequire(magrittr)\n\nLoading required package: magrittr\n\nrequire(tibble)\n\nLoading required package: tibble\n\nrequire(raster)\n\nLoading required package: raster\n\n\nLoading required package: sp\n\n\n\nAttaching package: 'raster'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\nrequire(stringr)\n\nLoading required package: stringr\n\nrequire(tidyr)\n\nLoading required package: tidyr\n\n\n\nAttaching package: 'tidyr'\n\n\nThe following object is masked from 'package:raster':\n\n    extract\n\n\nThe following object is masked from 'package:magrittr':\n\n    extract\n\nlibrary(caret)\n\nLoading required package: ggplot2\n\n\nLoading required package: lattice\n\nlibrary(gbm)\n\nLoaded gbm 2.1.8.1\n\nlibrary(doParallel)\n\nLoading required package: foreach\n\n\nLoading required package: iterators\n\n\nLoading required package: parallel\n\nrequire(readr)\n\nLoading required package: readr\n\n\n\n\nParallel set up\nWe applied several strategies for parallelisation. For instance, we created a full dataset, but we repeat the model fitting process for each assessment unit (group of glacier outlines) using a PBS script. Within each session, we also use the doParallel library to speed up some of the steps of model fitting.\n\n# Programing environment variables\nenv_file_path &lt;- \"proyectos/Tropical-Glaciers/T6.1-tropical-glaciers-suitability-model/\"\nsource(\n    sprintf(\n        \"%s/%s/env/project-env.R\",\n        Sys.getenv(\"HOME\"),\n        env_file_path\n    )\n)\ninput.dir &lt;- sprintf(\"%s/%s/OUTPUT\",gis.out,\"T6.1-tropical-glaciers-data\")\noutput.dir &lt;- sprintf(\"%s/%s/GBMmodel\",gis.out,projectname)\n\n# Read command line arguments for each copy run within a batch PBS job\nargs = commandArgs(trailingOnly=TRUE)\npick &lt;- as.numeric(args[1])\n\n\n\nPreparation of input data\nOccurrence records were selected using stratified random sampling from all the glacier outlines in tropical areas and 25 km distance buffers around glacier outlines.\n\n## Load spatial data for the group polygons and glacier points\ngrp_table &lt;- \n  read_sf(sprintf(\"%s/gisdata/trop-glacier-groups-labelled.gpkg\",input.dir)) %&gt;%\n  st_drop_geometry %&gt;%\n  transmute(id = factor(id), unit_name = group_name)\ntrop_glaciers_classified &lt;- \n  readRDS(file=sprintf(\"%s/Rdata/Inner-outer-wet-dry-glacier-classification.rds\",\n  input.dir))\nall_units &lt;- unique(grp_table$unit_name)\nslc_unit &lt;- all_units[ifelse(is.na(pick), 6, pick)]\n\nexclude &lt;- c(\"Temperate Glacier Ecosystems\", \"Famatina\", \"Norte de Argentina\", \"Zona Volcanica Central\")\n\nif (slc_unit %in% exclude) {\n  stop(\"Skipping temperate and transitional glacier ecosystems\")\n}\n\nsystem(sprintf('mkdir -p %s/%s', output.dir, str_replace_all(slc_unit, \" \", \"-\")))\n\nWe used 19 bioclimatic variables from the CHELSA dataset representing climatological mean values for present conditions (1981-2010) as predictor variables. Eight variables were excluded from the model due to high correlation to other variables. Variables were centered and scaled to zero mean and unit variance.\n\n# Read the data extracted from the raster files for each polygon, and saved into a Rdata file.\n\nrda.file &lt;- sprintf(\"%s/current-bioclim-data-all-groups.rda\",output.dir)\nif (file.exists(rda.file)) {\n   load(rda.file)\n} else {\n   stop(\"input_raster_data is missing\")\n}\n\nWe applied a first partition of the data by withhold the occurrence records of the target assessment unit for final model evaluation of prediction performance of the model (target partition) and the rest of the occurrence records were used for model fitting (modeling partition). Random subsets of the modeling partition were divided in calibration (80%) and test partitions (20%) for tuning of model parameters (number of trees, interaction depth, shrinkage and minimum number of observations per node) using cross validation.\n\n# Exclude low elevations\ninput_data &lt;- input_raster_data %&gt;%\n   tibble %&gt;%\n   mutate(id = factor(id)) %&gt;%\n   left_join(grp_table, by = \"id\") %&gt;%\n   filter(\n      !unit_name %in% slc_unit,\n      unit_name %in% all_units,\n      elevation_1KMmd &gt; 3500\n      ) %&gt;%\n  mutate(andes = grepl(\"Peru|Colombia|Ecuador\",unit_name))\n\ntt &lt;- table(input_data$id)\n\nsample_size &lt;- case_when(\n  slc_unit %in% \"Kilimanjaro\" ~ 5000L,\n  TRUE ~ 10000L\n)\nif (!grepl(\"Peru|Colombia|Ecuador\",slc_unit)) {\n  prob &lt;- if_else(input_data$glacier,5,.5)*if_else(input_data$andes,1,3)*(sum(tt)/tt[input_data$id])\n} else {\n  prob &lt;- if_else(input_data$glacier,5,.5)*(sum(tt)/tt[input_data$id])\n}\n\ntraining &lt;- input_data %&gt;%\n   slice_sample(n=sample_size, weight_by = prob) %&gt;%\n   dplyr::select(glacier,starts_with(\"bio_\")) %&gt;%\n   mutate(glacier=factor(if_else(glacier,\"G\",\"N\")))\n\ntesting &lt;- input_raster_data %&gt;%\n   tibble %&gt;%\n   mutate(id = factor(id)) %&gt;%\n   left_join(grp_table, by = \"id\") %&gt;%\n   filter(unit_name %in% slc_unit, elevation_1KMmd&gt;3500) %&gt;%\n   mutate(glacier = factor(if_else(glacier,\"G\",\"N\")))\n\n\n\nTune GBM model\nWe fitted the GBM model for classification (two classes: glacier or not-glacier) using a bernoulli error distribution.\nModel tuning was based on some suggestions from https://topepo.github.io/caret/model-training-and-tuning.html#metrics\n\nctrl &lt;- trainControl(\n   method = \"cv\",\n   number = 10\n)\n\nfitControl &lt;- trainControl(method = \"repeatedcv\",\n                           number = 10,\n                           repeats = 10,\n                           ## Estimate class probabilities\n                           classProbs = TRUE,\n                           ## Evaluate performance using \n                           ## the following function\n                           summaryFunction = twoClassSummary)\n\ntuneGrid &lt;- expand.grid(\n   n.trees = c(50, 75, 100, 125, 150, 200),\n   interaction.depth = (1:5),\n   shrinkage = c(0.05, 0.1, 0.5),\n   n.minobsinnode = c(5, 7, 10, 12)\n)\n\n\n\nRun GBM per region\nNow we can run the GBM for each group using data from other groups and evaluate the predictive performance of the final model on the target partition.\nHere we use a parallel cluster, see https://topepo.github.io/caret/parallel-processing.html.\n\n## Register cluster for parallel processing\ncl &lt;- makeCluster(detectCores()-1)\nregisterDoParallel(cl)\n\nmodel &lt;- caret::train(\n   glacier ~ .,\n   data = training,\n   method = 'gbm',\n   distribution=\"bernoulli\",\n   preProcess = c(\"center\", \"scale\"),\n   trControl = fitControl,\n   tuneGrid = tuneGrid,\n   ## Specify which metric to optimize\n   metric = \"ROC\",\n   verbose = TRUE\n)\n\n## stop parallel cluster\nstopCluster(cl)\n\nAnd we can inspect the final model with:\n\nmodel\nplot(model)\n\n\n\nEvaluate predictive performance\nWe calculate the model prediction at the testing and training locations for model evaluation and also save model, training and testing subsets for further processing.\n\ntest.features = testing %&gt;% dplyr::select(starts_with(\"bio_\"))\ntest.target = testing %&gt;% pull(glacier)\n\nrda.results &lt;- sprintf(\n   '%s/%s/gbm-model-current.rda',\n   output.dir,\n   str_replace_all(slc_unit,\" \",\"-\")\n   )\n\n\npredictions = predict(model, newdata = test.features, type='prob')\ntesting$IV &lt;- predictions[,\"G\"]\n\npredictions = predict(model,  type='prob')\ntraining$IV &lt;- predictions[,\"G\"]\n\nsave(file=rda.results,model,training,testing,slc_unit )\n\n\n\nPrediction and projection\nWe used the final fitted model to predict the suitability in the present timeframe (1981-2010) and future timeframes (2011-2040 and 2041-2071). We considered uncertainty due to climate change projections (five general circulation models and three representative pathways), and due to the choice of cut-off values to classify predicted suitability into binary score (glacier/non-glacier):\n\nmodeled prevalence is closest to observed prevalence\nmaximum sum of the sensitivity (true positive rate) and specificity (true negative rate),\nequal sensitivity and specificity\n\nWe summarised the outcomes for each combination of models, pathways and cut-off values and calculated relative severity of each outcome in two ways.",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  },
  {
    "objectID": "IND/indicator-variables.html",
    "href": "IND/indicator-variables.html",
    "title": "2  Direct and indirect indicators",
    "section": "",
    "text": "Here we examine trade-offs between the use of direct and indirect indicators of functional decline. It is always recommended to select indicators that are proximal to causes, effects and mechanisms of ecosystem change (i.e. Direct indicators). Sometimes these indicators are difficult to obtain or the available data show temporal and spatial gaps and bias in coverage. Indirect indicators, such as generic or aggregated variables, can be useful in assessment if they can fill these gaps, but might be less sensitive to real ecosystem change.\nWe selected one direct and one indirect indicator variable, both linked to the same underlying abiotic process (climate change, see Figure 1.2), to predict trajectories of degradation leading to ecosystem collapse. For the direct indicator we used model projections of ice mass as described in Chapter 3. For the indirect indicator we generated estimates bioclimatic suitability for glaciers, our methods are described in ?sec-suitability.",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Direct and indirect indicators</span>"
    ]
  },
  {
    "objectID": "FORM/functional-degradation.html",
    "href": "FORM/functional-degradation.html",
    "title": "5  Dimensions of ecosystem degradation",
    "section": "",
    "text": "Assessing degradation of ecosystem function is challenging, in part because it may occur via a wide array of ecosystem-specific mechanisms and pathways, and also because related concepts of ecosystem condition are inherently vague (Keith, 2015).\nThe RLE protocol provides a framework for analysing trends in diverse ecosystem-specific indicators (Nicholson et al., 2024), which are mathematically standardised for assessment (Bland et al., 2017; Keith et al., 2013).\nRLE criteria addressing functional symptoms of collapse (C and D), assess the magnitude of environmental degradation and disruption of biotic processes in ecosystems based on the relative severity and proportional extent of decline.\nRelative severity (RS) is the estimated relative magnitude of change in an indicator towards a threshold that defines a major change of state (ecosystem collapse) in a system of interest, expressed as a percentage relative to a change large enough to cause ecosystem collapse (Bland et al., 2017). Thus, a relative severity of 50% over a specified time frame represents a change in indicator value of half the magnitude that would be expected to result in ecosystem collapse.\nEstimation of RS therefore requires a time frame, a measure or estimate of observed decline and a measure or estimate of maximum decline. The suggested formula for RS uses a simple range standardisation (Bland et al., 2017). The Extent of Decline (ED) is a measure of the proportion of the ecosystem affected by a given level of Relative Severity. Thus, ED is derived from the distribution of RS values calculated for an ecosystem across its range.\nWe provide explicit formulation for calculation of these metrics in Chapter 6 and Chapter 8.\n\n\n\n\nBland, L.M., Keith, D.A., Miller, R.M., Murray, N.J., Rodríguez, J.P. (Eds.), 2017. Guidelines for the application of IUCN red list of ecosystems categories and criteria. Version 1.1. IUCN International Union for Conservation of Nature. https://doi.org/10.2305/iucn.ch.2016.rle.3.en\n\n\nKeith, D.A., 2015. Assessing and managing risks to ecosystem biodiversity. Austral Ecology 40, 337–346. https://doi.org/10.1111/aec.12249\n\n\nKeith, D.A., Rodríguez, J.P., Rodríguez-Clark, K.M., Nicholson, E., Aapala, K., Alonso, A., Asmussen, M., Bachman, S., Basset, A., Barrow, E.G., Benson, J.S., Bishop, M.J., Bonifacio, R., Brooks, T.M., Burgman, M.A., Comer, P., Comín, F. a, Essl, F., Faber-Langendoen, D., Fairweather, P.G., Holdaway, R.J., Jennings, M., Kingsford, R.T., Lester, R.E., Nally, R.M., McCarthy, M.A., Moat, J., Oliveira-Miranda, M.A., Pisanu, P., Poulin, B., Regan, T.J., Riecken, U., Spalding, M.D., Zambrano-Martínez, S., 2013. Scientific foundations for an IUCN red list of ecosystems. PLoS ONE 8, e62111. https://doi.org/10.1371/journal.pone.0062111\n\n\nNicholson, E., Andrade, A., Driver, A., Ferrer-Paris, J.R., Keith, D., Sievers, M., Stevenson, S., 2024. Beyond the headline: Roles of the red list of ecosystems in implementing the kunming-montreal global biodiversity framework. Nature Ecology and Evolution. https://doi.org/10.1038/s41559-023-02320-5",
    "crumbs": [
      "Relative Severity and Extent of Decline",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Dimensions of ecosystem degradation</span>"
    ]
  },
  {
    "objectID": "A1/Kilimanjaro.html",
    "href": "A1/Kilimanjaro.html",
    "title": "Appendix B — T.G.E. Kilimanjaro",
    "section": "",
    "text": "B.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\nFigure B.1: Time series of relative severity of ice mass loss. Original RS formula.\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>T.G.E. Kilimanjaro</span>"
    ]
  },
  {
    "objectID": "A1/Colombia.html",
    "href": "A1/Colombia.html",
    "title": "Appendix D — T.G.E. Cordilleras de Colombia",
    "section": "",
    "text": "D.1 Compare overall RS\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>D</span>  <span class='chapter-title'>T.G.E. Cordilleras de Colombia</span>"
    ]
  },
  {
    "objectID": "A1/Cordillera-de-Merida.html",
    "href": "A1/Cordillera-de-Merida.html",
    "title": "Appendix C — T.G.E. Cordillera de Merida",
    "section": "",
    "text": "C.1 Compare overall RS\nNow we can calculate the relative severity per year estimated from the mass balance model and compare this value with the relative severity estimated from the suitability model.\nWarning: Removed 808 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n\nFigure C.1: Time series of relative severity of ice mass loss. Original RS formula.\n`summarise()` has grouped output by 'ssp', 'threshold', 'timeframe', 'year'.\nYou can override using the `.groups` argument.\n\n\nWarning: Removed 24 rows containing non-finite values (`stat_boxplot()`).",
    "crumbs": [
      "Appendices",
      "Results per assessment unit",
      "<span class='chapter-number'>C</span>  <span class='chapter-title'>T.G.E. Cordillera de Merida</span>"
    ]
  },
  {
    "objectID": "IND/suitability-model.html#model-diagnosis",
    "href": "IND/suitability-model.html#model-diagnosis",
    "title": "4  Bioclimatic suitability model",
    "section": "4.2 Model diagnosis",
    "text": "4.2 Model diagnosis\nHere we show the results for one assessment unit: the tropical glacier ecosystems of Mexico.\n\nload(here::here(\"sandbox\",\"fitted-GBM-models\",\"Mexico.rda\")) # this includes slc_unit\n\nFirst we explore the ensemble of models:\n\nmodel$finalModel\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\nThen we can select the best fitting model\n\nmodel$finalModel\n\nA gradient boosted model with bernoulli loss function.\n200 iterations were performed.\nThere were 19 predictors of which 19 had non-zero influence.\n\n\nWe can calculate variable importance:\n\nvarImp(model)\n\ngbm variable importance\n\n       Overall\nbio_05 100.000\nbio_09  28.710\nbio_10  26.025\nbio_13  25.914\nbio_03  16.564\nbio_01  14.167\nbio_14  12.592\nbio_15  10.920\nbio_12  10.194\nbio_04  10.087\nbio_18   9.943\nbio_19   9.165\nbio_16   8.614\nbio_08   7.733\nbio_07   5.639\nbio_06   5.047\nbio_17   4.007\nbio_02   2.553\nbio_11   0.000\n\n\n\nplot(model)\n\n\n\n\n\n\n\n\nThis is a problem, the cutoff value is very high because the model overfits!\n\nboxplot(IV~glacier,testing)\n\n\nplot_a &lt;- ggplot(testing) + geom_point(aes(x=bio_05,y=IV,colour=glacier))\nplot_b &lt;- ggplot(training) + geom_point(aes(x=bio_05,y=IV,colour=glacier))\nggarrange(plot_a,plot_b)\n\n\n\n\n\nAnderson, R.P., 2013. A framework for using niche models to estimate impacts of climate change on species distributions. Annals of the New York Academy of Sciences 1297. https://doi.org/10.1111/nyas.12264\n\n\nFerrer-Paris, J.R., Zager, I., Keith, D.A., Oliveira-Miranda, M.A., Rodríguez, J.P., Josse, C., González-Gil, M., Miller, R.M., Zambrana-Torrelio, C., Barrow, E., 2019. An ecosystem risk assessment of temperate and tropical forests of the americas with an outlook on future conservation strategies. Conservation Letters 12, e12623. https://doi.org/10.1111/conl.12623\n\n\nKarger, D.N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H., Soria-Auza, R.W., Zimmermann, N.E., Linder, H.P., Kessler, M., 2018. Data from: Climatologies at high resolution for the earth’s land surface areas. https://doi.org/10.5061/DRYAD.KD1D4\n\n\nKarger, D.N., Conrad, O., Böhner, J., Kawohl, T., Kreft, H., Soria-Auza, R.W., Zimmermann, N.E., Linder, H.P., Kessler, M., 2017. Climatologies at high resolution for the earth’s land surface areas. Scientific Data. https://doi.org/10.1038/sdata.2017.122\n\n\nKeith, D.A., Elith, J., Simpson, C.C., 2014. Predicting distribution changes of a mire ecosystem under future climates. Diversity and Distributions 20, 440–454. https://doi.org/https://doi.org/10.1111/ddi.12173\n\n\nMurray, N.J., Keith, D.A., Duncan, A., Tizard, R., Ferrer-Paris, J.R., Worthington, T.A., Armstrong, K., Hlaing, N., Htut, W.T., Oo, A.H., Ya, K.Z., Grantham, H., 2020. Myanmars terrestrial ecosystems: Status, threats and conservation opportunities. Biological Conservation 252, 108834. https://doi.org/10.1016/j.biocon.2020.108834",
    "crumbs": [
      "Indicator variables",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Bioclimatic suitability model</span>"
    ]
  }
]